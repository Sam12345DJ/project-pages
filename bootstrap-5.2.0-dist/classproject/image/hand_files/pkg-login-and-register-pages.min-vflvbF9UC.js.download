define("metaserver/static/js/abuse/captcha_helper",["require","exports","tslib","metaserver/static/js/modules/constants/login_and_register","metaserver/static/js/modules/constants/page_load","metaserver/static/js/clean/web_timing_logger","metaserver/static/js/core/assert","metaserver/static/js/core/exception","metaserver/static/js/core/uri"],(function(e,t,s,a,r,i,o,n,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DUMMY_RESPONSE=t.BuildRecaptchaURI=t.isTest=t.LoadRecaptcha=t.ClearCaptchaPromise=t.HasCaptchaLoaded=t.captchaPromise=void 0,a=s.__importStar(a),n=s.__importStar(n);let c=!1;t.HasCaptchaLoaded=function(){return null!=t.captchaPromise},t.ClearCaptchaPromise=function(){t.captchaPromise=null},t.LoadRecaptcha=function(e,s){return void 0!==s&&(c=s),t.captchaPromise||(t.captchaPromise=e?new Promise((e,t)=>{(0,i.waitForTTI)().then(e),setTimeout(e,2500)}).then(u):u()),t.captchaPromise};function p(){const e={onload:"recaptchaOnloadCallback",render:"explicit",hl:r.USER_LOCALE.replace("_","-")};return new l.URI({scheme:"https",authority:"www.google.com",path:"/recaptcha/api.js",query:e}).toString()}function u(){return new Promise((r,i)=>{if(window.recaptchaOnloadCallback=function(){r(window.grecaptcha)},a.SHOULD_LOAD_FUNCAPTCHA&&c&&new Promise((t,s)=>{e(["metaserver/static/js/abuse/funcaptcha_modal"],t,s)}).then(s.__importStar).then(({loadFuncaptchaModal:e,recordFunCaptchaLoadingStats:t})=>{const s=performance.now();let a,r="",i=!1;try{e(),i=!0}catch(e){r=e.message}finally{a=performance.now()}t("funcaptcha_modal_loading",a-s,i,r)}),(0,t.isTest)())r(_);else{const e=document.createElement("script"),t=p();e.setAttribute("src",t);const s=window.CSP_SCRIPT_NONCE;if(!s)return n.reportException({err:new Error("CSP nonce not set"),severity:n.SEVERITY.CRITICAL,tags:["product-safety-infra","recaptcha"]}),void i();e.setAttribute("nonce",s),document.body.appendChild(e)}})}t.isTest=()=>a.IS_SELENIUM_TEST,t.BuildRecaptchaURI=p;const d={},m={};let g=0;t.DUMMY_RESPONSE="DUMMY-RESPONSE";const h=e=>{e.setAttribute("class","g-recaptcha-response"),e.setAttribute("name","g-recaptcha-response"),e.value=""},_={reset(e){const t=m[e].querySelector(".g-recaptcha-response");return h(t),!0},render(e,s,a){const r=g;g+=1,(0,o.assert)(null==e.querySelector(".g-recaptcha-response"),"can't render multiple recaptcha elements in same div");const i=document.createElement("textarea");return i.id=`g-recaptcha-response-${r}`,h(i),e.appendChild(i),m[r]=e,d[r]=()=>{const e=t.DUMMY_RESPONSE;return i.value=e,s.callback&&s.callback(e),e},r},execute:e=>Promise.resolve(d[e]())}})),define("metaserver/static/js/auth/common/captcha",["require","exports","tslib","classnames","react","metaserver/static/js/components/ui/css","metaserver/static/js/abuse/captcha_helper"],(function(e,t,s,a,r,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Captcha=t.CaptchaComponent=t.clear_captcha_response=t.handle_captcha_errors=t.get_captcha_responses=void 0,a=s.__importDefault(a),r=s.__importDefault(r),t.get_captcha_responses=function(e){const t=e.getWrappedComponent();return{"g-recaptcha-response":t.recaptcha_response,"funcaptcha-response":t.funcaptcha_response}},t.handle_captcha_errors=function(e,t,s){return e.getWrappedComponent().handle_captcha_errors(t,s)},t.clear_captcha_response=function(e){return e.getWrappedComponent().clear_captcha_response()};class n extends r.default.Component{constructor(e){super(e)}handle_captcha_errors(t,a){return!(!t||!t.funcaptcha_response)&&(new Promise((t,s)=>{e(["metaserver/static/js/abuse/funcaptcha_modal"],t,s)}).then(s.__importStar).then(({openFuncaptchaModal:e})=>{e(this.props.email||"",a||this.props.source,e=>{this.funcaptcha_response=e,this.props.onSubmit()},this.props.onReady)}),!0)}clear_captcha_response(){this.funcaptcha_response=void 0}componentDidMount(){(0,o.LoadRecaptcha)(void 0,!0)}render(){return r.default.createElement("div",{ref:"container_div",className:(0,a.default)({"recaptcha-v2-challenge-container":!0,"recaptcha-v2-challenge-container--invisible":!0})},r.default.createElement("div",{ref:"captcha_div",className:"recaptcha_v2_challenge"}))}submit(){this.clear_captcha_response(),this.props.onSubmit()}}t.CaptchaComponent=n,n.displayName="CaptchaComponent",t.Captcha=(0,i.requireCssWithComponent)(n,["/static/metaserver/static/css/recaptcha-vflIN6j39.css"])})),define("metaserver/static/js/auth/common/utils",["require","exports","tslib","metaserver/static/js/auth/login/types","metaserver/static/js/auth/register/types","metaserver/static/js/modules/constants/page_load","metaserver/static/js/core/i18n","metaserver/static/js/core/notify","metaserver/static/js/core/uri","metaserver/static/js/form_util/name_parser","metaserver/static/js/clean/marketing_tracker"],(function(e,t,s,a,r,i,o,n,l,c,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.pushMarketingEvent=t.notifyCaptchaNotLoaded=t.twoFactorRecoveryUrl=t.getFormattedName=t.lastNameGoesFirst=t.genErrorId=t.generateId=void 0,c=s.__importDefault(c);t.generateId=e=>e+Math.random().toString().slice(2);t.genErrorId=e=>`${e}__input-error`;const u=["ja","ko","zh"];t.lastNameGoesFirst=()=>u.includes(i.USER_LOCALE.slice(0,2));t.getFormattedName=(e,s,a)=>{if(!a)return[e,s];const[r,i]=c.default.splitFullName(e);return(0,t.lastNameGoesFirst)()?i?[i,r]:[e,s]:[r,i]};t.twoFactorRecoveryUrl=(e,t)=>{const s=new l.URI({path:"/twofactor_recovery"});return e&&s.updateQuery({remember_me:e.toString()}),t&&!["/",""].includes(t)&&s.updateQuery({cont:t}),s.toString()};t.notifyCaptchaNotLoaded=()=>{n.Notify.warning(o.intl.formatMessage({id:"977N0X",defaultMessage:"Your browser appears to be blocking dropboxcaptcha.com, which is required for authentication. To resolve this issue, please update any anti-virus or ad-blocking software settings to allow connections to dropboxcaptcha.com."}))};t.pushMarketingEvent=(e,t)=>{let s;switch(e){case a.LoginFormEvent.LOGIN_CLICK:case a.LoginFormEvent.GOOGLE_LOGIN_CLICK:case a.LoginFormEvent.APPLE_LOGIN_CLICK:case r.RegisterFormEvent.REGISTER_CLICK:case r.RegisterFormEvent.GOOGLE_REGISTER_CLICK:if(!t)return;s={form_event:e},p.MarketingTracker.tryPushEvent("conversionDataReady",p.EventTypeEnum.Link,s);break;case a.LoginFormEvent.LOGIN_IMMEDIATE_SUCCESS:case a.LoginFormEvent.GOOGLE_LOGIN_SUCCESS:case a.LoginFormEvent.APPLE_LOGIN_SUCCESS:s=(0,p.getGAEventData)(p.MARKETING_LOGIN_EVENT,p.MARKETING_LOGIN_EVENT),p.MarketingTracker.tryPushEvent(p.MARKETING_LOGIN_EVENT,p.EventTypeEnum.Link,s);break;case r.RegisterFormEvent.REGISTER_IMMEDIATE_SUCCESS:case r.RegisterFormEvent.GOOGLE_REGISTER_SUCCESS:s=(0,p.getGAViewData)(p.MARKETING_REGISTER_EVENT,"ga_register_pageview","/virtual/ga_register_pageview"),p.MarketingTracker.tryPushEvent(p.MARKETING_REGISTER_EVENT,p.EventTypeEnum.View,s)}}})),define("metaserver/static/js/auth/common/error",["require","exports","tslib","dompurify","react"],(function(e,t,s,a,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AuthError=void 0,a=s.__importDefault(a),r=s.__importDefault(r);class i extends r.default.Component{shouldComponentUpdate(e){return this.hasNewError(e.error)}hasNewError(e){var t;return!this.hasMatchingErrorMessage(e)||(null==e?void 0:e.clientTimestamp)!==(null===(t=this.props.error)||void 0===t?void 0:t.clientTimestamp)}hasMatchingErrorMessage(e){var t,s;return(null==e?void 0:e.message_html)===(null===(t=this.props.error)||void 0===t?void 0:t.message_html)&&(null==e?void 0:e.message_text)===(null===(s=this.props.error)||void 0===s?void 0:s.message_text)}render(){const{error:e,errorId:t}=this.props;return e&&e.message_html?r.default.createElement("div",{id:t,"aria-live":"polite","aria-atomic":"true",className:"text-input-error-wrapper",dangerouslySetInnerHTML:{__html:a.default.sanitize(e.message_html)}}):e&&e.message_text?r.default.createElement("div",{id:t,"aria-live":"polite","aria-atomic":"true",className:"text-input-error-wrapper"},r.default.createElement("span",{className:"error-message"},e.message_text,r.default.createElement("span",{className:"text-input-error-hidden ax-visually-hidden","aria-hidden":"true",style:{visibility:"hidden"}},e.clientTimestamp))):r.default.createElement("div",{id:t,"aria-live":"polite","aria-atomic":"true",className:"text-input-error-wrapper"})}}t.AuthError=i,i.displayName="AuthError"})),define("metaserver/static/js/auth/common/inputs/checkbox",["require","exports","tslib","dompurify","react","classnames","metaserver/static/js/auth/common/error","metaserver/static/js/auth/common/utils","metaserver/static/js/auth/common/types","dig-components/form_row","dig-components/controls","dig-components/icons","dig-components/icons/src"],(function(e,t,s,a,r,i,o,n,l,c,p,u,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AuthCheckbox=void 0,a=s.__importDefault(a),r=s.__importStar(r),i=s.__importDefault(i);const m=e=>{const{label:t,htmlFor:s,unsafeLabelHTML:i}=e;return t?r.default.createElement("label",{htmlFor:s,className:"checkbox_label"},r.default.createElement("span",null,t)):i?r.default.createElement("label",{htmlFor:s,className:"checkbox_label"},r.default.createElement("span",{dangerouslySetInnerHTML:{__html:a.default.sanitize(i)}})):null},g=e=>{const{name:t,error:s,label:i,onChange:o,className:n,checked:l,id:g,errorId:h,uxaEventName:_,disabled:f,autoFocus:E}=e,S=s&&(s.message_text||s.message_html);return r.default.createElement("div",{className:"auth__checkbox-row"},r.default.createElement(c.FormRow,{variant:"control"},r.default.createElement(p.Checkbox,{className:n,name:t,id:g,onChange:o,checked:l,"aria-checked":l,"aria-invalid":S?"true":"false","aria-describedby":h,"data-uxa-log":_,disabled:f,autoFocus:E}),r.default.createElement(m,{htmlFor:g,label:i})),r.default.createElement("div",{id:h,"aria-live":"polite","aria-atomic":"true"},S&&r.default.createElement(c.FormHelperText,{isInvalid:!0},r.default.createElement(u.UIIcon,{src:d.FailLine,size:"small"}),(null==s?void 0:s.message_html)?r.default.createElement("span",{dangerouslySetInnerHTML:{__html:a.default.sanitize(s.message_html)}}):r.default.createElement("span",null,null==s?void 0:s.message_text))))};t.AuthCheckbox=e=>{const{checked:t,className:s,disabled:a,error:c,inline:p,label:u,maestroStyle:d,name:h,onChange:_,unsafeLabelHTML:f,variant:E,uxaEventName:S}=e,v=(0,r.useMemo)(()=>(0,n.generateId)(h),[h]),T=(0,r.useMemo)(()=>(0,n.genErrorId)(v),[v]),b=c&&(c.message_text||c.message_html);if(E===l.AuthFormVariant.DIG20)return r.default.createElement(g,Object.assign({},e,{id:v,errorId:T}));const I=(0,i.default)("checkbox",E,s,{"checkbox-inline":p});let C=r.default.createElement("input",{type:"checkbox",id:v,name:h,checked:t,onChange:_,disabled:a,"aria-invalid":b?"true":"false","aria-describedby":T,"data-uxa-log":S});d&&(C=r.default.createElement("label",{className:"maestro_checkbox",htmlFor:v},C,r.default.createElement("span",null)));const O=r.default.createElement(o.AuthError,{error:c,errorId:T});return r.default.createElement("div",{className:I},!d&&O,C,r.default.createElement(m,{htmlFor:v,label:u,unsafeLabelHTML:f}),d&&O)},t.AuthCheckbox.displayName="AuthCheckbox"})),define("metaserver/static/js/auth/common/inputs/text",["require","exports","tslib","classnames","react","dompurify","metaserver/static/js/core/i18n","classnames","metaserver/static/js/auth/common/error","metaserver/static/js/auth/common/types","metaserver/static/js/auth/common/utils","metaserver/static/js/components/password_strength_meter","dig-components/text_fields","dig-components/form_row","dig-components/icons","dig-components/icons/src","metaserver/static/js/clean/ui/input_dig"],(function(e,t,s,a,r,i,o,n,l,c,p,u,d,m,g,h,_){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AuthTextField=void 0,a=s.__importDefault(a),r=s.__importStar(r),i=s.__importDefault(i),n=s.__importDefault(n);const f=e=>{const t=(0,a.default)("text-input-input",e.className,{"input-error":e.hasError,"numeric-input":e.type===c.AuthTextInputType.NUMBER}),s=e.passwordStrengthProps||{},i=o.intl.formatMessage({id:"/uvN/C",defaultMessage:"Good passwords are hard to guess. Use uncommon words or inside jokes, non-standard uPPercasing, creative spelllling, and non-obvious numbers and symbols"});return r.default.createElement("div",{className:"text-input-wrapper"},(!e.value||e.persistLabel)&&r.default.createElement("label",{className:(0,a.default)({"persistent-label":e.persistLabel}),htmlFor:e.id},e.placeholder),r.default.createElement("input",{id:e.id,type:e.type,className:t,name:e.name,value:e.value,onChange:e.onChange,disabled:e.disabled,autoFocus:e.autoFocus,autoComplete:e.autoComplete?"on":"off","aria-describedby":e.errorId,"aria-invalid":e.hasError?"true":"false",inputMode:e.type===c.AuthTextInputType.NUMBER?"numeric":"text",onKeyDown:e.type===c.AuthTextInputType.NUMBER?e=>{!0===e.ctrlKey||!0===e.metaKey||8===e.keyCode||46===e.keyCode||9===e.keyCode||13===e.keyCode||e.keyCode>=48&&e.keyCode<=57||e.keyCode>=96&&e.keyCode<=105||144===e.keyCode||37===e.keyCode||39===e.keyCode||e.preventDefault()}:void 0}),e.type===c.AuthTextInputType.PASSWORD&&e.measureStrength&&r.default.createElement(u.PasswordStrengthMeter,{password:e.value||"",zxcvbnPostTti:!0,className:e.variant,bubblePosition:s.position,bubbleDescription:s.description||i,bubbleClassName:s.className}))},E=e=>{const{disabled:t,name:s,placeholder:a,error:o,onChange:l,measureStrength:c,type:p,errorId:u}=e,f=!(!o||!o.message_text&&!o.message_html);return r.default.createElement("div",{className:"auth__input-wrapper"},c?r.default.createElement(_.password,{name:"password",className:(0,n.default)("auth__password-input",{"is-invalid":f}),measureStrength:!0,placeholder:a,onChange:l,"aria-describedby":u,"aria-invalid":f?"true":"false"}):r.default.createElement(d.TextInput,{disabled:t,isInvalid:f,name:s,onChange:l,placeholder:a,wrapperProps:{className:"auth__input-field"},type:p,"aria-describedby":u,"aria-invalid":f?"true":"false"}),r.default.createElement("div",{id:u,"aria-live":"polite","aria-atomic":"true"},f&&r.default.createElement(m.FormHelperText,{isInvalid:!0},r.default.createElement(g.UIIcon,{src:h.FailLine,size:"small"}),(null==o?void 0:o.message_html)?r.default.createElement("span",{dangerouslySetInnerHTML:{__html:i.default.sanitize(o.message_html)}}):r.default.createElement("span",null,null==o?void 0:o.message_text))))};t.AuthTextField=e=>{const{name:t,variant:s,error:i,maestroStyle:o,onChange:n,value:u,disabled:d,inputClassName:m,type:g,placeholder:h,measureStrength:_,passwordStrengthProps:S,autoComplete:v,autoFocus:T,label:b,className:I}=e,C=(0,r.useMemo)(()=>(0,p.generateId)(t),[t]),O=(0,r.useMemo)(()=>(0,p.genErrorId)(C),[C]);if(s===c.AuthFormVariant.DIG20)return r.default.createElement(E,Object.assign({},e,{errorId:O}));const y=o?null:I,L=(0,a.default)("text-input",s,y),N=e.styledError,A=N?r.default.createElement(N,{id:O}):r.default.createElement(l.AuthError,{errorId:O,error:i}),R=!!(N||i&&(i.message_html||i.message_text)),w=r.default.createElement("div",{className:L},!o&&A,r.default.createElement(f,{id:C,errorId:O,name:t,onChange:n,value:u,disabled:d,className:m,hasError:R,variant:s,type:g,placeholder:h,measureStrength:_,passwordStrengthProps:S,autoComplete:v||!1,autoFocus:T||!1,persistLabel:!!e.persistLabel}),o&&A);if(!o)return w;const M=(0,a.default)(I,{"register-form__name-field":"email"!==g&&"password"!==g,"register-form__field":"email"===g||"password"===g});return r.default.createElement("div",{className:M},b&&r.default.createElement("label",{className:"register-form__field-label",htmlFor:C},b),w)},t.AuthTextField.displayName="AuthTextField"})),define("metaserver/static/js/auth/common/stats",["require","exports","tslib","metaserver/static/js/clean/analytics","metaserver/static/js/core/browser","metaserver/static/js/core/browser_detection","metaserver/static/js/core/exception","metaserver/static/js/auth/login/types","metaserver/static/js/metrics/index"],(function(e,t,s,a,r,i,o,n,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.logUXAnalytics=t.AppleUXAnalyticsLogger=t.GoogleUXAnalyticsLogger=t.EmailAuthUXAnalyticsLogger=t.AuthUXAnalyticsLogger=t.AuthAMPLogger=t.AuthType=void 0,r=s.__importStar(r),i=s.__importStar(i);var c;(function(e){e.CREDENTIALS="email",e.GOOGLE="google_auth",e.GOOGLE_ONE_TAP="google_one_tap",e.APPLE="apple_auth"})(c=t.AuthType||(t.AuthType={}));const p=new Set(["form_error","user_exists","access_denied","tfa_required","sso_required","emails_do_not_match_redirect"]),u=new Set(["enable_twofactor_required","emails_do_not_match","emails_do_not_match_redirect","not_verified","email_not_verified","google_login_not_allowed","access_denied","disabled_account","tos_required","sso_required","no_email_in_response","requires_password_on_first_link","apple_login_not_allowed","apple_login_not_allowed_for_teams","user_cancelled_authorize"]);function d(e){return{url:r.get_href(),status:e.status?e.status:void 0}}function m(e){return{url:r.get_href(),remember_me:e.remember_me?e.remember_me.toString():void 0,pair_user:e.pair_user?e.pair_user.toString():void 0,err_msg:e.err_msg?e.err_msg:void 0}}function g(e,t){return e&&t.has(e)?e:"unknown"}function h(){const e=[[i.chrome,"chrome"],[i.edge,"edge"],[i.mozilla,"firefox"],[i.msie,"msie"],[i.safari,"safari"]];let t="other";for(const[s,a]of e)if(s){t=a;break}return t}function _(e,t,s=1){try{(0,l.getMetricsReporter)().createStats({ns:"web_auth",name:e},Object.assign(Object.assign({},t),{browser:h()})).record(s)}catch(s){(0,o.reportException)({err:s,severity:o.SEVERITY.NONCRITICAL,tags:["web_auth_amp_logging","acquisition_eng"],exc_extra:Object.assign({metricName:e},t)})}}function f(e,t){a.UXAnalyticsLogger.log(e,t)}t.AuthAMPLogger={logSignupIntent(){_("signup/intent",{},1)},logSignupAttempt(e){_("signup/attempt",{authType:e},1)},logSignupResponse(e,t,s){"funcaptcha_response"!==s?t?_("signup/success",{authType:e},1):(_("signup/success",{authType:e},0),_("signup/failure",{authType:e,error:g(s,p)},1)):_("signup/failure",{authType:e,error:s},1)},logLoginIntent(e){_("login/intent",{loginType:e||"normal"},1)},logLoginAttempt(e,t){_("login/attempt",{authType:e,loginType:t||"normal"},1)},logCredentialsLoginResponse(e,t){const s=c.CREDENTIALS,a=e||"normal";if("funcaptcha_response"!==t)if(t===n.LoginResponseStatus.OK||t===n.LoginResponseStatus.TWOFACTOR)_("login/success",{authType:s,loginType:a},1);else{let e;switch(t){case n.LoginResponseStatus.TOS_SIGNATURE_REQUIRED:e="tos_required";break;case n.LoginResponseStatus.SSO:e="sso_required";break;case n.LoginResponseStatus.TWOFACTOR_REQUIRED:e="enable_twofactor_required";break;case n.LoginResponseStatus.RATELIMIT:e="rate_limited";break;case n.LoginResponseStatus.EXPIRED:e="login_expired";break;case n.LoginResponseStatus.PASSWORD_EXPIRED:e="password_expired";break;case n.LoginResponseStatus.PASSWORD_DECRYPTION_ERROR:e="password_descryption_error";break;case n.LoginResponseStatus.ERROR:e="generic_error";break;case"form_error":e=t;break;default:e="unknown"}_("login/success",{authType:s,loginType:a},0),_("login/failure",{authType:s,loginType:a,error:e},1)}else _("login/failure",{authType:s,loginType:a,error:t},1)},logThirdPartyLoginResponse(e,t,s,a){const r=t||"normal";s||"tfa_required"===a?_("login/success",{authType:e,loginType:r},1):(_("login/success",{authType:e,loginType:r},0),_("login/failure",{authType:e,loginType:r,error:g(a,u)},1))},log2faResponse(e,t){const s=e||"normal";if(t===n.LoginResponseStatus.OK)_("2fa/success",{loginType:s},1);else{let e;switch(t){case n.LoginResponseStatus.REQUIRES_ROLE:e="requires_role";break;case n.LoginResponseStatus.EXPIRED:e="twofactor_expired";break;case n.LoginResponseStatus.INVALID_CREDENTIALS:e="invalid_credentials";break;case n.LoginResponseStatus.ERROR:e="generic_error";break;case"u2f_error":case"code_error":e=t;break;default:e="unknown"}_("2fa/success",{loginType:s},0),_("2fa/failure",{loginType:s,error:e},1)}}},t.AuthUXAnalyticsLogger={logSignupModalShown(e,t={}){f("signup_modal_shown",Object.assign({url:r.get_href(),kind:e},t))},logLoginModalShown(e,t={}){f("login_modal_shown",Object.assign({url:r.get_href(),kind:e},t))},logSignupModalDismissed(e){f("signup_modal_dismissed",{url:r.get_href(),kind:e})},logLoginModalDismissed(e){f("login_modal_dismissed",{url:r.get_href(),kind:e})},logRecoverableErrorShown(){f("login_recoverable_error_shown",{url:r.get_href()})},logDisabledErrorShown(){f("login_disabled_error_shown",{url:r.get_href()})},logRecoverableErrorDismissed(){f("login_recoverable_error_dismissed",{url:r.get_href()})},logDisabledErrorDismissed(){f("login_disabled_error_dismissed",{url:r.get_href()})}},t.EmailAuthUXAnalyticsLogger={logLoginStart(){f("email_login_start",{url:r.get_href()})},logSplitSignupContinue(){f("email_split_signup_continue",{url:r.get_href()})},logLoginResponse(e){switch(e.status){case n.LoginResponseStatus.OK:f("email_login_succeeded",d(e));break;case n.LoginResponseStatus.TWOFACTOR:f("email_login_requires_two_factor",d(e));break;case n.LoginResponseStatus.TWOFACTOR_REQUIRED:case n.LoginResponseStatus.TOS_SIGNATURE_REQUIRED:case n.LoginResponseStatus.EXPIRED:case n.LoginResponseStatus.SSO:f("email_login_redirect",d(e));break;default:f("email_login_failed",d(e))}},logLoginError(){f("email_login_failed",{url:r.get_href()})},logSignupStart(){f("email_signup_start",{url:r.get_href()})},logSignupResponse(){f("email_signup_succeeded",{url:r.get_href()})},logSignupError(){f("email_signup_failed",{url:r.get_href()})}},t.GoogleUXAnalyticsLogger={logLoginStart(){f("google_login_start",{url:r.get_href()})},logLoginResponse(e){e.success?f("google_login_succeeded",m(e)):"tfa_required"===e.err_msg?f("google_login_requires_two_factor",m(e)):f("google_login_failed",m(e))},logSignupStart(){f("google_signup_start",{url:r.get_href()})},logSignupResponse(e){e.success?f("google_signup_succeeded",m(e)):f("google_signup_failed",m(e))},logSuccessfulLogin(){f("google_signup_succeeded",{url:r.get_href()})}},t.AppleUXAnalyticsLogger={logLoginStart(){f("sia_login_start",{url:r.get_href()})},logLoginResponse(e){e.success?f("sia_login_succeeded",m(e)):"tfa_required"===e.err_msg?f("sia_login_requires_two_factor",m(e)):"requires_password_on_first_link"===e.err_msg?f("sia_login_requires_password",m(e)):f("sia_login_failed",m(e))}},t.logUXAnalytics=f})),define("metaserver/static/js/auth/common/types",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AuthFormVariant=t.AuthButtonVariant=t.AuthTextInputType=void 0,(function(e){e.EMAIL="email",e.PASSWORD="password",e.TEXT="text",e.NUMBER="number"})(t.AuthTextInputType||(t.AuthTextInputType={})),(function(e){e.BIG="big",e.SMALL="small",e.STANDARD="standard"})(t.AuthButtonVariant||(t.AuthButtonVariant={})),(function(e){e.PAPER_COMPACT="paper-compact",e.SMALL="small",e.STANDARD="standard",e.DIG20="dig20"})(t.AuthFormVariant||(t.AuthFormVariant={}))})),define("metaserver/static/js/auth/login/2fa/authenticator_form",["require","exports","tslib","classnames","react","metaserver/static/js/core/i18n","metaserver/static/js/auth/common/inputs/text","metaserver/static/js/auth/common/types","metaserver/static/js/auth/common/utils","metaserver/static/js/auth/login/2fa/trust_checkbox"],(function(e,t,s,a,r,i,o,n,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Authenticator2FAForm=void 0,a=s.__importDefault(a),r=s.__importDefault(r);t.Authenticator2FAForm=e=>{const t=r.default.createElement("button",{className:(0,a.default)("mc-button mc-button-primary",{"inline-submit":e.inlineSubmit,"login-button":!e.inlineSubmit}),type:"submit"},i.intl.formatMessage({id:"K57Ot6",defaultMessage:"Enter"}));return r.default.createElement("form",{className:"two-factor-form clearfix 2fa-phone-form",onSubmit:e.onSubmit},e.displayHeader&&r.default.createElement("div",{className:"login-header"},i.intl.formatMessage({id:"FFqVaU",defaultMessage:"Enter Dropbox 2-step verification code"})),r.default.createElement("div",{className:"login-info two-factor-uses-authenticator"},i.intl.formatMessage({id:"sufs69",defaultMessage:"Enter the code generated by your authenticator app."})),r.default.createElement("div",{className:(0,a.default)({"inline-input-submit-pair":e.inlineSubmit,"backup-verification-code-form":e.inlineSubmit})},r.default.createElement(o.AuthTextField,{className:"login-text-input inline-input",disabled:!1,error:e.error,maestroStyle:e.maestroStyle,name:"code",onChange:e.onInputChange,value:e.value,placeholder:i.intl.formatMessage({id:"DFLqLE",defaultMessage:"6-digit code"}),type:n.AuthTextInputType.NUMBER,variant:e.variant,autoFocus:!0,autoComplete:!1,persistLabel:!0}),e.inlineSubmit&&t),!e.hideTrustCheckbox&&r.default.createElement(c.TwoFactorTrustCheckbox,{checked:e.trusted,maestroStyle:e.maestroStyle,onChange:e.onInputChange,tooltipPosition:e.trustTooltipPosition,variant:e.variant}),!e.inlineSubmit&&t,!e.hideHelp&&r.default.createElement("div",{className:"two-factor-need-help"},r.default.createElement("a",{href:(0,l.twoFactorRecoveryUrl)(e.rememberMe,e.continuationUrl),className:"twofactor_recovery_url"},i.intl.formatMessage({id:"gR0Vz1",defaultMessage:"Having trouble getting a code?"}))))}})),define("metaserver/static/js/auth/login/2fa/email_form",["require","exports","tslib","classnames","react","metaserver/static/js/core/i18n","metaserver/static/js/auth/common/inputs/text","metaserver/static/js/auth/common/types"],(function(e,t,s,a,r,i,o,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Email2FAForm=void 0,a=s.__importDefault(a),r=s.__importDefault(r);t.Email2FAForm=e=>{const t=r.default.createElement("button",{className:(0,a.default)("mc-button mc-button-primary",{"inline-submit":e.inlineSubmit,"login-button":!e.inlineSubmit}),type:"submit"},i.intl.formatMessage({id:"K57Ot6",defaultMessage:"Enter"}));return r.default.createElement("form",{className:"two-factor-form clearfix 2fa-email-form",onSubmit:e.onSubmit},e.displayHeader&&r.default.createElement("div",{className:"login-header"},i.intl.formatMessage({id:"FFqVaU",defaultMessage:"Enter Dropbox 2-step verification code"})),r.default.createElement("div",{className:"login-info two-factor-uses-email"},i.intl.formatMessage({id:"FuPzY9",defaultMessage:"We sent a code to {email} and any devices youâ€™ve linked to this account. Enter the code to continue."},{span:e=>r.default.createElement("span",{className:"tfa-email"},e),email:e.email})),r.default.createElement("div",{className:(0,a.default)({"inline-input-submit-pair":e.inlineSubmit,"backup-verification-code-form":e.inlineSubmit})},r.default.createElement(o.AuthTextField,{className:"login-text-input inline-input",disabled:!1,error:e.error,maestroStyle:e.maestroStyle,name:"code",onChange:e.onInputChange,value:e.value,placeholder:i.intl.formatMessage({id:"DFLqLE",defaultMessage:"6-digit code"}),type:n.AuthTextInputType.NUMBER,variant:e.variant,autoFocus:!0,autoComplete:!1,persistLabel:!0}),e.inlineSubmit&&t),!e.inlineSubmit&&t,r.default.createElement("div",{className:"two-factor-need-help"},r.default.createElement("a",{href:"#",onClick:e.onResendCodeClick,className:"resend-two-factor-code two-factor-uses-sms"},i.intl.formatMessage({id:"HTy4qW",defaultMessage:"Resend code"}))))}})),define("metaserver/static/js/auth/login/2fa/phone_form",["require","exports","tslib","classnames","react","metaserver/static/js/core/i18n","metaserver/static/js/auth/common/inputs/text","metaserver/static/js/auth/common/types","metaserver/static/js/auth/common/utils","metaserver/static/js/auth/login/2fa/trust_checkbox"],(function(e,t,s,a,r,i,o,n,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Phone2FAForm=void 0,a=s.__importDefault(a),r=s.__importDefault(r);t.Phone2FAForm=e=>{const t=r.default.createElement("button",{className:(0,a.default)("mc-button mc-button-primary",{"inline-submit":e.inlineSubmit,"login-button":!e.inlineSubmit}),type:"submit"},i.intl.formatMessage({id:"K57Ot6",defaultMessage:"Enter"}));return r.default.createElement("form",{className:"two-factor-form clearfix 2fa-phone-form",onSubmit:e.onSubmit},e.displayHeader&&r.default.createElement("div",{className:"login-header"},i.intl.formatMessage({id:"FFqVaU",defaultMessage:"Enter Dropbox 2-step verification code"})),r.default.createElement("div",{className:"login-info two-factor-uses-sms"},i.intl.formatMessage({id:"lWPbUP",defaultMessage:"We sent a code to your phone number ending in <span>{last_two_digits}</span>."},{span:e=>r.default.createElement("span",{className:"last-two-digits"},e),last_two_digits:e.lastTwoDigits})),r.default.createElement("div",{className:(0,a.default)({"inline-input-submit-pair":e.inlineSubmit,"backup-verification-code-form":e.inlineSubmit})},r.default.createElement(o.AuthTextField,{className:"login-text-input inline-input",disabled:!1,error:e.error,maestroStyle:e.maestroStyle,name:"code",onChange:e.onInputChange,value:e.value,placeholder:i.intl.formatMessage({id:"DFLqLE",defaultMessage:"6-digit code"}),type:n.AuthTextInputType.NUMBER,variant:e.variant,autoFocus:!0,autoComplete:!1,persistLabel:!0}),e.inlineSubmit&&t),!e.hideTrustCheckbox&&r.default.createElement(c.TwoFactorTrustCheckbox,{checked:e.trusted,maestroStyle:e.maestroStyle,onChange:e.onInputChange,tooltipPosition:e.trustTooltipPosition,variant:e.variant}),!e.inlineSubmit&&t,!e.hideHelp&&r.default.createElement("div",{className:"two-factor-need-help"},r.default.createElement("a",{href:"#",onClick:e.onResendCodeClick,className:"resend-two-factor-code two-factor-uses-sms"},i.intl.formatMessage({id:"HTy4qW",defaultMessage:"Resend code"})),r.default.createElement("a",{href:(0,l.twoFactorRecoveryUrl)(e.rememberMe,e.continuationUrl),className:"twofactor_recovery_url"},i.intl.formatMessage({id:"gR0Vz1",defaultMessage:"Having trouble getting a code?"}))))}})),define("metaserver/static/js/auth/login/2fa/seckey_form",["require","exports","tslib","react","metaserver/static/js/core/i18n","metaserver/static/js/auth/login/2fa/trust_checkbox","metaserver/static/js/auth/login/types","metaserver/static/js/clean/ui/image","metaserver/static/js/clean/ui/sprite","metaserver/static/js/clean/static_urls"],(function(e,t,s,a,r,i,o,n,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SecKey2FAForm=void 0,a=s.__importDefault(a);const p=()=>a.default.createElement(n.Image,{src:(0,c.static_url)("/static/metaserver/static/images/security_keys/insert-vflkCfC4_.png"),srcHiRes:(0,c.static_url)("/static/metaserver/static/images/security_keys/insert@2x-vflTxG2RJ.png"),className:"seckey-insert"}),u=()=>a.default.createElement(n.Image,{src:(0,c.static_url)("/static/metaserver/static/images/icons/ajax-loading-small-vfl3Wt7C_.gif"),srcHiRes:(0,c.static_url)("/static/metaserver/static/images/icons/ajax-loading-small@2x-vflAxdZTP.gif"),className:"seckey-loading-status"}),d=e=>a.default.createElement("div",{className:"two-factor-seckey-instructions"},a.default.createElement("p",null,a.default.createElement("span",{style:{fontWeight:"bold"}},r.intl.formatMessage({id:"DljPpW",defaultMessage:"Insert your security key to use it"}))," ",e.securityKeyState===o.SecurityKeyState.LOADING&&a.default.createElement(u,null),e.securityKeyState===o.SecurityKeyState.FOUND&&a.default.createElement(m,null)),r.intl.formatMessage({id:"eonxEJ",defaultMessage:"After inserting, tap your key if it has a button or gold disk."})),m=()=>a.default.createElement(l.Sprite,{group:"web",name:"bulletpoint-check",alt:"",className:"seckey-loading-status"});t.SecKey2FAForm=e=>a.default.createElement("form",{className:"two-factor-form clearfix 2fa-seckey-form"},e.displayHeader&&a.default.createElement("div",{className:"login-header"},r.intl.formatMessage({id:"FFqVaU",defaultMessage:"Enter Dropbox 2-step verification code"})),a.default.createElement("div",{className:"login-info two-factor-uses-u2f"},a.default.createElement(p,null),e.securityKeyState!==o.SecurityKeyState.NOT_FOUND&&a.default.createElement(d,{securityKeyState:e.securityKeyState}),a.default.createElement("div",{className:"text-input"},a.default.createElement("div",{className:"text-input-error-wrapper"})),e.securityKeyState===o.SecurityKeyState.NOT_FOUND&&a.default.createElement("div",{className:"two-factor-seckey-instructions"},a.default.createElement("div",{style:{color:"red"}},a.default.createElement("span",{className:"error-msg"},e.error||r.intl.formatMessage({id:"uqQwD8",defaultMessage:"Key not found."}))),a.default.createElement("button",{className:"button-tertiary two-factor-seckey-retry",onClick:e.onRetry},r.intl.formatMessage({id:"n1zYou",defaultMessage:"Retry"}))),!e.hideTrustCheckbox&&a.default.createElement(i.TwoFactorTrustCheckbox,{checked:e.trusted,maestroStyle:e.maestroStyle,onChange:e.onInputChange,tooltipPosition:e.trustTooltipPosition,variant:e.variant}),a.default.createElement("div",{className:"two-factor-use-phone-instead"},a.default.createElement("a",{href:"#",onClick:e.onChange2FA},e.secondaryTwoFactorType===o.TwoFactorType.SMS?r.intl.formatMessage({id:"cDmyI0",defaultMessage:"Send SMS instead"}):r.intl.formatMessage({id:"yzAIpy",defaultMessage:"Use mobile authenticator instead"})))))})),define("metaserver/static/js/auth/login/2fa/trust_checkbox",["require","exports","tslib","react","metaserver/static/js/core/browser_detection","metaserver/static/js/core/i18n","metaserver/static/js/auth/common/inputs/checkbox","metaserver/static/js/clean/ui/sprite_div","metaserver/static/js/clean/ui/tooltip"],(function(e,t,s,a,r,i,o,n,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TestOnlyTrustTooltipContent=t.TwoFactorTrustCheckbox=void 0,a=s.__importDefault(a),r=s.__importStar(r),n=s.__importDefault(n),l=s.__importStar(l);const c=()=>a.default.createElement("div",{className:"two-factor-trusted-info"},r.is_mobile_or_tablet()?i.intl.formatMessage({id:"UkQZnd",defaultMessage:"Trusted devices will never ask you for a security code again. You should only trust this device if you trust everyone who uses it."}):i.intl.formatMessage({id:"UraGyT",defaultMessage:"Trusted computers will never ask you for a security code again. You should only trust this computer if you trust everyone who uses it."}));t.TestOnlyTrustTooltipContent=c;const p=e=>a.default.createElement("div",{className:"tooltip-wrapper info-icon"},a.default.createElement(l.Tooltip,{position:l.TooltipPosition[e.position||"TOP"],tooltip_classname:"twofactor-trust-tooltip",tooltip_contents:a.default.createElement(c,null)},a.default.createElement(n.default,{group:"web",name:"info",alt:i.intl.formatMessage({id:"+SX5vq",defaultMessage:"More information"}),text:r.is_mobile_or_tablet()?i.intl.formatMessage({id:"+79s4f",defaultMessage:"Trust this device"}):i.intl.formatMessage({id:"Ey/8Q8",defaultMessage:"Trust this computer"}),spritePosition:"right"})));t.TwoFactorTrustCheckbox=e=>a.default.createElement(o.AuthCheckbox,{className:"remember-me",name:"trusted",checked:e.checked,inline:!0,disabled:!1,maestroStyle:e.maestroStyle,onChange:e.onChange,variant:e.variant,label:a.default.createElement(p,{position:e.tooltipPosition})})})),define("metaserver/static/js/auth/login/api",["require","exports","tslib","metaserver/static/js/deprecated_ajax/ajax_as_promised_jquery","metaserver/static/js/api_v2/default_user_client","metaserver/static/js/auth/login/types","metaserver/static/js/clean/viewer","metaserver/static/js/clean/viewer_refresh","metaserver/static/js/core/assert","metaserver/static/js/core/exception","metaserver/static/js/core/i18n"],(function(e,t,s,a,r,i,o,n,l,c,p){"use strict";function u(){const e=o.Viewer.get_viewer().get_users()[0];return(0,l.assert)(null!=e,"Expect user is logged in when pairing"),new r.DefaultUserApiV2Client(e)}function d(e){var t;return(null===(t=null==e?void 0:e.error)||void 0===t?void 0:t[".tag"])?{status:i.LoginResponseStatus.ERROR,html_response:!1,message:e.message}:{status:i.LoginResponseStatus.ERROR,html_response:!1,message:p.intl.formatMessage({id:"vuVMnM",defaultMessage:"Something went wrong."})}}function m(e){return s.__awaiter(this,void 0,void 0,(function*(){const t=e.login_email,s=e.encrypted_password;(0,l.assert)(null!=t&&null!=s,"Expect login email and password not null");const a=u(),r={login_email:t,encrypted_password:s,remember_me:e.remember_me};try{const e=yield a.ns("team").rpc("account_pair_login",r,{});return e.two_factor_request?e.two_factor_request:e}catch(e){return d(e)}}))}function g(e){return s.__awaiter(this,void 0,void 0,(function*(){const t=e.login_email,s=e.encrypted_password;(0,l.assert)(null!=t&&null!=s,"Expected login email and password not null");const a=u(),r={login_email:t,encrypted_password:s,remember_me:e.remember_me};try{const e=yield a.ns("team").rpc("link_user_login",r,{});return e.two_factor_request?e.two_factor_request:e}catch(e){return d(e)}}))}function h(e){return s.__awaiter(this,void 0,void 0,(function*(){const t=e.checkpoint_token,s=e.code;(0,l.assert)(null!=t&&null!=s,"Expect checkpoint token and code not null");const a=u(),r={checkpoint_token:t,code:s,remember_me:e.remember_me};try{return yield a.ns("team").rpc("account_pair_two_factor_login",r,{})}catch(e){return d(e)}}))}Object.defineProperty(t,"__esModule",{value:!0}),t.updateDropboxPasswordsEligibility=t.submitTwoFactorForm=t.retryU2fAuthentication=t.resendTwoFactorCode=t.submitCredentialsForm=t.accountPairTwoFactorLogin=t.linkUserLogin=t.accountPairLogin=t.checkSsoState=void 0,a=s.__importStar(a),t.checkSsoState=function(e){return new Promise(t=>a.WebRequest({url:"/sso_state",data:{email:e},success:e=>t(JSON.parse(e))}))},t.accountPairLogin=m,t.linkUserLogin=g,t.accountPairTwoFactorLogin=h,t.submitCredentialsForm=function(e,t){let s;switch(e){case"multi":s="/ajax_multi_login";break;case"pairing":s="/team/join/new_pair_login_ajax";break;case"cli_link_nonce":s="/cli_link_nonce";break;case"bidirectional_pair":return m(t);case"link_user":return g(t);default:s="/ajax_login"}return new Promise((e,r)=>a.WebRequest({url:s,type:"POST",data:t,skipNotifyError:!0,success:t=>{e(JSON.parse(t))},error:(t,s,a)=>{"{"!==a[0]&&-1===a.indexOf(":")?e({status:i.LoginResponseStatus.ERROR,html_response:!1,message:a}):r(JSON.parse(a))}}))},t.resendTwoFactorCode=function(e,t){return new Promise((s,r)=>a.WebRequest({url:"/twofactor_resend",data:{backup:e,mobile_push:t},success:s,error:r}))},t.retryU2fAuthentication=function(){return new Promise((e,t)=>a.WebRequest({url:"/account/twofactor/u2f_start_authentication",success:e,error:t}))},t.submitTwoFactorForm=function(e,t){let s;switch(e){case"multi":s="/ajax_multi_verify_code";break;case"pairing":s="/team/join/new_pair_login_ajax";break;case"cli_link_nonce":s="/cli_link_twofactor";break;case"admin":s="/admin/login/twofactor";break;case"bidirectional_pair":return h(t);default:s="/ajax_verify_code"}return new Promise((e,r)=>a.WebRequest({url:s,type:"POST",data:t,success:t=>e(JSON.parse(t)),error:(e,t,s)=>r(JSON.parse(s))}))},t.updateDropboxPasswordsEligibility=function(e){return s.__awaiter(this,void 0,void 0,(function*(){o.Viewer.get_viewer().is_signed_in||(yield(0,n.refreshViewerAfterLogin)());try{const t=u();yield t.ns("passwords").rpc("update_freemium_eligibility",{entry_point:{".tag":e}},{})}catch(e){(0,c.reportException)({err:e,severity:"non-critical"})}}))}})),define("metaserver/static/js/auth/login/apple_login_button",["require","exports","tslib","react","classnames","metaserver/static/js/core/i18n","metaserver/static/js/auth/login/login_error","typescript/component_libraries/dwg-components/src/components/dwg-sso-button/index"],(function(e,t,s,a,r,i,o,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AppleLoginButton=void 0,a=s.__importDefault(a),r=s.__importDefault(r);t.AppleLoginButton=e=>{const t=e.buttonProps||{},s=t.text||i.intl.formatMessage({id:"pTMcB4",defaultMessage:"Sign in with Apple"});return a.default.createElement("div",{className:"login-form-container__apple-div"},a.default.createElement(n.DWGSSOButton,{onClick:e.onClick,classes:(0,r.default)("auth-apple"),disabled:e.disabled||t.disabled,service:"apple",width:"full",dataUxaLog:"sia_login_start"},s),e.error&&a.default.createElement(o.LoginError,{className:"apple-login-error",message:e.error}))}})),define("metaserver/static/js/auth/login/credentials_form",["require","exports","tslib","classnames","react","metaserver/static/js/core/browser_detection","metaserver/static/js/core/i18n","metaserver/static/js/auth/common/inputs/checkbox","metaserver/static/js/auth/common/inputs/text","metaserver/static/js/auth/common/types","metaserver/static/js/auth/common/captcha","metaserver/static/js/auth/login/login_error","metaserver/static/js/auth/login/google_login_button","metaserver/static/js/auth/login/apple_login_button","metaserver/static/js/auth/login/types","metaserver/static/js/clean/ui/image","metaserver/static/js/clean/ui/sprite_div","metaserver/static/js/clean/static_urls","metaserver/static/js/abuse/fingerprintjs_component","metaserver/static/js/google_one_tap/containers"],(function(e,t,s,a,r,i,o,n,l,c,p,u,d,m,g,h,_,f,E,S){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LoginCredentialsForm=void 0,a=s.__importDefault(a),r=s.__importDefault(r),_=s.__importDefault(_);const v=e=>{let t="/forgot",s=e.target;return e.appendEmail&&(t=`/forgot?email_from_login=${e.email}`,s=void 0),r.default.createElement("a",{className:"forgot-password-link",href:t,target:s,"data-uxa-log":"forgot_your_password_cta","data-trackingid":"forgot_your_password_cta"},e.text||o.intl.formatMessage({id:"ovBgtz",defaultMessage:"Forgot your password?"}))},T=e=>r.default.createElement("div",{id:"navisite"},r.default.createElement("br",null),r.default.createElement("a",{href:"/navi_redirect/login",target:e.openLinkInNewTab?"_blank":void 0},o.intl.formatMessage({id:"vnuqfB",defaultMessage:"Dropbox NAVI"}))),b=e=>r.default.createElement("div",{className:"sso-optout"},o.intl.formatMessage({id:"F1g1bb",defaultMessage:"or"})," ",r.default.createElement("a",{href:"#",onClick:e.onClick},o.intl.formatMessage({id:"fRMS5E",defaultMessage:"Log in with Dropbox credentials"}))),I=()=>r.default.createElement("span",{className:"login-loading-indicator ajax-loading"},r.default.createElement(h.Image,{src:(0,f.static_url)("/static/metaserver/static/images/icons/ajax-loading-small-vfl3Wt7C_.gif"),srcHiRes:(0,f.static_url)("/static/metaserver/static/images/icons/ajax-loading-small@2x-vflAxdZTP.gif")})),C=()=>r.default.createElement("div",{className:"sso-description"},r.default.createElement(_.default,{group:"web",name:"lock",text:o.intl.formatMessage({id:"WH73xS",defaultMessage:"Single sign-on enabled"})})),O=e=>r.default.createElement("div",{className:"credentials-form__fields"},r.default.createElement(l.AuthTextField,{value:e.emailValue,className:(0,a.default)("login-text-input","login-email",e.emailProps.className),onChange:e.onInputChange,disabled:e.disabled||e.emailProps.readonly||!1,label:e.emailProps.label||(e.maestroStyle?o.intl.formatMessage({id:"hK3Vsp",defaultMessage:"Email"}):void 0),placeholder:e.emailProps.placeholder||(e.maestroStyle?o.intl.formatMessage({id:"mx5U0y",defaultMessage:"you@mail.com"}):o.intl.formatMessage({id:"hK3Vsp",defaultMessage:"Email"})),error:e.emailError,styledError:e.styledEmailError,maestroStyle:e.maestroStyle,name:"login_email",type:c.AuthTextInputType.EMAIL,variant:e.variant,persistLabel:e.persistLabel}),e.ssoState===g.SsoState.OFF&&r.default.createElement(l.AuthTextField,{value:e.passwordValue,placeholder:e.passwordProps.placeholder||(e.maestroStyle?o.intl.formatMessage({id:"JtdF1I",defaultMessage:"Your password"}):o.intl.formatMessage({id:"i+PJQ7",defaultMessage:"Password"})),name:"login_password",className:(0,a.default)("login-text-input","login-password",e.passwordProps.className),error:e.passwordError,inputClassName:"password-input",onChange:e.onInputChange,measureStrength:!1,label:e.passwordProps.label||(e.maestroStyle?o.intl.formatMessage({id:"i+PJQ7",defaultMessage:"Password"}):void 0),maestroStyle:e.maestroStyle,disabled:e.disabled,variant:e.variant,type:c.AuthTextInputType.PASSWORD,persistLabel:e.persistLabel}));class y extends r.default.Component{constructor(){super(...arguments),this.setCaptchaComponent=e=>{this.captchaComponent=e},this.setFingerprintJsComponent=e=>{this.fingerprintJsComponent=e},this.getCaptchaResponses=()=>this.props.supportsCaptcha?(0,p.get_captcha_responses)(this.captchaComponent):{},this.handleCaptchaErrors=e=>!!this.props.supportsCaptcha&&(0,p.handle_captcha_errors)(this.captchaComponent,e),this.submitRecaptcha=()=>{this.props.supportsCaptcha?this.captchaComponent.getWrappedComponent().submit():this.props.onSubmit()}}getFingerprintJsComponent(){return this.fingerprintJsComponent}render(){const e=this.props.rememberMeProps||{},t=this.props.googleLoginProps,s=this.props.appleLoginProps,l=(0,a.default)({clearfix:!this.props.hideRememberMe||!this.props.hideHelp&&(0,i.is_supported_mobile_browser)()}),h=this.props.openLinksInNewTab?"_blank":void 0,_=(0,a.default)("clearfix","credentials-form","login-form",{"sso-required":this.props.ssoState!==g.SsoState.OFF,"sso-optional":this.props.ssoState===g.SsoState.OPTIONAL}),f=t&&t.positionBelow,y=t&&!t.positionBelow,L=s&&s.positionBelow,N=s&&!s.positionBelow,A=f||L,R=y||N,w=["V1","V2"].includes(this.props.googleOneTapVariant||""),M=w?r.default.createElement(S.DefaultButtonContainerFC,{context:"signin",gsiState:this.props.gsiState}):t?r.default.createElement(d.GoogleLoginButton,{buttonProps:t.buttonProps,disabled:this.props.disabled||this.props.isSubmitting,error:this.props.googleLoginError,onClick:this.props.onGoogleLoginClick}):null,P=s?r.default.createElement(m.AppleLoginButton,{buttonProps:s.buttonProps,disabled:this.props.disabled||this.props.isSubmitting,error:this.props.appleLoginError,onClick:this.props.onAppleLoginClick}):null,F=this.props.hideHelp||this.props.ssoState===g.SsoState.REQUIRED?null:r.default.createElement(v,{email:this.props.emailValue,target:h,appendEmail:void 0===this.props.forgotPasswordProps.appendEmail||this.props.forgotPasswordProps.appendEmail,text:this.props.forgotPasswordProps.text}),G=r.default.createElement("button",{className:(0,a.default)("login-button","signin-button","button-primary",this.props.loginButtonProps.className),type:"submit",disabled:this.props.disabled||this.props.isSubmitting||this.props.loginButtonProps.disabled},this.props.ssoState===g.SsoState.OFF&&r.default.createElement("div",{className:"signin-text"},this.props.loginButtonProps.text||o.intl.formatMessage({id:"raLp6W",defaultMessage:"Sign in"})),this.props.ssoState!==g.SsoState.OFF&&r.default.createElement("div",{className:"sso-text"},o.intl.formatMessage({id:"LgJiOW",defaultMessage:"Continue"}))),k=r.default.createElement("div",{className:"hr-label"},r.default.createElement("span",{className:"hr-label__text"},o.intl.formatMessage({id:"F1g1bb",defaultMessage:"or"}))),D=this.props.variant===c.AuthFormVariant.PAPER_COMPACT,x=this.props.isPaperLogin;let U,j;(function(e){e[e.INLINE_WITH_LOGIN_BUTTON=0]="INLINE_WITH_LOGIN_BUTTON",e[e.ON_NEW_LINE=1]="ON_NEW_LINE",e[e.BELOW_FORM=2]="BELOW_FORM"})(U||(U={})),j=A||D?x&&!D?U.BELOW_FORM:U.INLINE_WITH_LOGIN_BUTTON:U.ON_NEW_LINE;const H=!!this.props.gsiState&&this.props.gsiState.isInline;return r.default.createElement("div",{className:"login-form-container--subcontainer"},y&&M,H&&r.default.createElement(S.DefaultContainerFC,{context:"signin",gsiState:this.props.gsiState}),w&&S.DEFAULT_TOS_INLINE_CONTAINER_LOGIN,N&&P,R&&!this.props.hideCredentialFields&&k,r.default.createElement("form",{className:_,onSubmit:this.props.onLoginClick,method:"POST",noValidate:!0},!this.props.hideCredentialFields&&r.default.createElement(O,{disabled:this.props.disabled,emailError:this.props.emailError,styledEmailError:this.props.styledEmailError,emailProps:this.props.emailProps,emailValue:this.props.emailValue,maestroStyle:this.props.maestroStyle,onInputChange:this.props.onInputChange,passwordError:this.props.passwordError,passwordProps:this.props.passwordProps,passwordValue:this.props.passwordValue,ssoState:this.props.ssoState,variant:this.props.variant,persistLabel:this.props.persistLabel}),this.props.loginError&&r.default.createElement(u.LoginError,{message:this.props.loginError}),r.default.createElement("div",{className:l},this.props.ssoState!==g.SsoState.OFF&&r.default.createElement(C,null),!this.props.hideRememberMe&&r.default.createElement(n.AuthCheckbox,{checked:this.props.rememberMeValue,className:"remember-me",disabled:e.disabled||this.props.disabled,inline:void 0===e.inline||e.inline,label:e.label||o.intl.formatMessage({id:"ztezCK",defaultMessage:"Remember me"}),maestroStyle:this.props.maestroStyle,name:"remember_me",onChange:this.props.onInputChange,variant:this.props.variant}),j===U.INLINE_WITH_LOGIN_BUTTON&&F,!D&&!this.props.hideCredentialFields&&G,this.props.isSubmitting&&r.default.createElement(I,null),this.props.ssoState===g.SsoState.OPTIONAL&&r.default.createElement(b,{onClick:this.props.onSsoChangeClick}),j===U.ON_NEW_LINE&&r.default.createElement("div",{className:"login-need-help"},F),this.props.showNaviSiteLogin&&r.default.createElement(T,{openLinkInNewTab:this.props.openLinksInNewTab}),D&&G)),f&&M,L&&P,j===U.BELOW_FORM&&r.default.createElement("div",{className:"login-need-help"},F),this.props.supportsCaptcha&&r.default.createElement(p.Captcha,{ref:this.setCaptchaComponent,email:this.props.emailValue,onSubmit:this.props.onSubmit,onReady:this.props.onCaptchaReady,source:"LOGIN"}),r.default.createElement(E.FingerprintJs,{ref:this.setFingerprintJsComponent,source:"LOGIN"}))}}t.LoginCredentialsForm=y,y.displayName="LoginCredentialsForm"})),define("metaserver/static/js/auth/login/email_error_banner",["require","exports","tslib","react","metaserver/static/js/components/ui/css","dig-components/banner","dig-components/icons","dig-components/icons/src","dig-components/typography","dig-components/buttons","metaserver/static/js/core/i18n"],(function(e,t,s,a,r,i,o,n,l,c,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LoginEmailDisabledErrorBanner=t.LoginEmailRecoverableErrorBanner=void 0,a=s.__importDefault(a),t.LoginEmailRecoverableErrorBanner=function(e){return a.default.createElement(u,{descriptionText:e.recoverableErrorMessage,onCreateNewAccount:e.onCreateNewAccount,onRequestClose:e.onRequestClose,bannerId:"login_recoverable_email_error",id:e.id})},t.LoginEmailDisabledErrorBanner=function(e){return a.default.createElement(u,{descriptionText:e.disabledErrorMessage,onCreateNewAccount:e.onCreateNewAccount,onReRegister:e.onReRegister,onRequestClose:e.onRequestClose,bannerId:"login_disabled_email_error",id:e.id})};const u=(0,r.requireCssWithComponent)(e=>{const{learnMoreAriaLabel:t,learnMoreText:s,reRegisterButtonText:r,createANewAccountButtonText:u,titleText:d}={learnMoreText:p.intl.formatMessage({id:"o4l0fJ",defaultMessage:"Learn more"}),learnMoreAriaLabel:p.intl.formatMessage({id:"OfSk0L",defaultMessage:"Learn more about being deleted from a Dropbox team."}),reRegisterButtonText:p.intl.formatMessage({id:"cEOkYU",defaultMessage:"Re-register email"}),createANewAccountButtonText:p.intl.formatMessage({id:"DpXKIj",defaultMessage:"Create a new account"}),titleText:p.intl.formatMessage({id:"XK9XCq",defaultMessage:"This account is deleted"})};return a.default.createElement(i.Banner,{className:"login-form-email-error-banner",id:e.id,onRequestClose:e.onRequestClose,type:"alert",variant:"rich",withCloseButton:"close",withLeftPictogram:a.default.createElement(o.PictogramIcon,{src:n.WarningPictogram})},a.default.createElement(i.Banner.Message,null,a.default.createElement(l.Title,{size:"small"},d),a.default.createElement(l.Text,null,e.descriptionText," ",a.default.createElement(l.Link,{"aria-label":t,"data-trackingid":"email-error-banner-learn-more",href:"/help/508"},s))),a.default.createElement(i.Banner.Actions,null,a.default.createElement(c.Button,{"data-uxa-log":`${e.bannerId}_reregister_click`,disabled:!Boolean(e.onReRegister),onClick:e.onReRegister,type:"button",variant:"outline"},r),a.default.createElement(c.Button,{"data-uxa-log":`${e.bannerId}_create_a_new_account_click`,onClick:e.onCreateNewAccount,variant:"transparent",type:"button"},u)))},["/static/metaserver/static/css/dig-components/index.web-vflVpv-hZ.css"])})),define("metaserver/static/js/auth/login/form",["require","exports","tslib","classnames","react","metaserver/static/js/core/assert","metaserver/static/js/core/browser","metaserver/static/js/core/exception","metaserver/static/js/core/html","metaserver/static/js/core/notify","metaserver/static/js/core/uri","metaserver/static/js/auth/common/types","metaserver/static/js/auth/common/utils","metaserver/static/js/auth/login/2fa/authenticator_form","metaserver/static/js/auth/login/2fa/email_form","metaserver/static/js/auth/login/2fa/phone_form","metaserver/static/js/auth/login/2fa/seckey_form","metaserver/static/js/auth/login/api","metaserver/static/js/auth/login/credentials_form","metaserver/static/js/auth/login/sso_utils","metaserver/static/js/auth/login/types","metaserver/static/js/components/ui/css","metaserver/static/js/core/i18n","metaserver/static/js/profile_services/profile_services_constants","metaserver/static/js/profile_services/profile_services_link","metaserver/static/js/auth/authenticator","metaserver/static/js/security/passwords","metaserver/static/js/auth/common/stats","metaserver/static/js/fedramp/fedramp_util","metaserver/static/js/auth/login/email_error_banner","metaserver/static/js/abuse/fingerprintjs_component","metaserver/static/js/google_one_tap/lib"],(function(e,t,s,a,r,i,o,n,l,c,p,u,d,m,g,h,_,f,E,S,v,T,b,I,C,O,y,L,N,A,R,w){"use strict";var M;Object.defineProperty(t,"__esModule",{value:!0}),t.TestOnlyLoginStep=t.TestOnlyLoginFormComponent=t.LoginForm=void 0,a=s.__importDefault(a),r=s.__importDefault(r),o=s.__importStar(o),f=s.__importStar(f),I=s.__importDefault(I),O=s.__importStar(O),R=s.__importStar(R),(function(e){e[e.CREDENTIALS_OR_SSO=0]="CREDENTIALS_OR_SSO",e[e.EMAIL_2FA=1]="EMAIL_2FA",e[e.PHONE_2FA=2]="PHONE_2FA",e[e.AUTHENTICATOR_2FA=3]="AUTHENTICATOR_2FA",e[e.SECKEY_2FA=4]="SECKEY_2FA"})(M||(M={})),t.TestOnlyLoginStep=M;class P extends r.default.Component{constructor(e){var t;super(e),this.testOnlyGetSsoChecker=()=>this.ssoChecker,this.setCredentialsFormComponent=e=>{this.credentialsFormComponent=e},this.testOnlyGetCredentialsFormComponent=()=>this.credentialsFormComponent,this.listenForContextChanges=()=>{this.clearContextChangesListener(),w.GSIEventManager.createGSIEventListener(w.GSIEvent.SSO_REQUIRED,this.handleContextChange)},this.clearContextChangesListener=()=>{w.GSIEventManager.removeGSIEventListener(w.GSIEvent.SSO_REQUIRED,this.handleContextChange)},this.handleContextChange=()=>{const e=w.GSIEventManager.getGSIState().email;this.setState({email:e}),this.setState({ssoState:v.SsoState.REQUIRED})},this.onInputChange=e=>{const t=e.currentTarget,s={},a=Object.assign({},this.state.localErrors);let r=!1;switch(t.name){case"login_email":s.email=t.value,a.email=void 0,a.styledEmailError=void 0,r=!0;break;case"login_password":s.password=t.value,a.password=void 0;break;case"remember_me":s.rememberMe=t.checked;break;case"trusted":s.trusted=t.checked;break;case"code":s.twoFactorCode=t.value,a.twoFactor=void 0}s.localErrors=a,this.setState(s,()=>{r&&this.ssoChecker.checkSsoState(s.email,this.onSsoStateUpdate)})},this.onSsoStateUpdate=(e,t)=>{e===this.state.email&&this.setState({ssoState:t})},this.onSsoChangeClick=()=>{(0,i.assert)(this.state.ssoState===v.SsoState.OPTIONAL,"User can change SSO state only when it is optional",{tags:["react-login-form"]}),this.setState({ssoState:v.SsoState.OFF})},this.generateThirdPartyAuthUrl=(e,t)=>{const s={fname:e.profile.given_name,lname:e.profile.family_name,email:e.profile.email,picture_url:e.profile.picture_url,refresh_token:e.refresh_token,email_sig:e.email_sig,automatic_redirect:t.toString(),cont:this.props.continuationUrl||"/"};return this.props.googleLoginProps&&this.props.googleLoginProps.signupTag&&(s.signup_tag=this.props.googleLoginProps.signupTag),this.props.googleLoginProps&&this.props.googleLoginProps.signupEndpoint&&(s.signup_endpoint=this.props.googleLoginProps.signupEndpoint),String(new p.URI({path:"/third_party_signup"}).updateQuery(s))},this.handleGoogleCallback=e=>s.__awaiter(this,void 0,void 0,(function*(){L.AuthAMPLogger.logThirdPartyLoginResponse(L.AuthType.GOOGLE,this.props.type,e.success,e.err_msg),L.GoogleUXAnalyticsLogger.logLoginResponse(e);let t=(0,N.getFedrampRedirectUrlIfApplicable)(e.is_fedramp_user||!1,this.props.continuationUrl||"/");if(e.profile&&!R.isTest()&&(yield this.credentialsFormComponent.getFingerprintJsComponent().getWrappedComponent().postFPJSTokenAndLog(e.profile.email)),e.success)this.handleLoginFormEvent(v.LoginFormEvent.GOOGLE_LOGIN_SUCCESS),!1!==this.props.canRedirect?(c.Notify.success(b.intl.formatMessage({id:"Ce9FpX",defaultMessage:"Log in successful! Your browser will be redirected in a few seconds."})),o.redirect(t)):e.is_fedramp_user&&!this.props.forceOnLoginSuccess?(t=(0,N.getFedrampRedirectUrlIfApplicable)(!0,this.props.continuationUrl||o.get_href()),o.redirect(t)):this.props.onLoginSuccess&&this.props.onLoginSuccess({display_name:e.display_name,id:e.user_id,email:e.profile.email,is_fedramp_user:e.is_fedramp_user});else if("emails_do_not_match_redirect"===e.err_msg){const t=this.props.googleLoginProps,s=t&&t.customErrorHandlers;if(s&&s.emailsDoNotMatchRedirect)s.emailsDoNotMatchRedirect(e);else{const t=this.generateThirdPartyAuthUrl(e,!0);o.redirect(t)}}else if("emails_do_not_match"===e.err_msg)if("pairing"!==this.props.type&&this.props.variant===u.AuthFormVariant.STANDARD){const t=this.generateThirdPartyAuthUrl(e,!1),s=b.intl.formatMessage({id:"6AHSKo",defaultMessage:"Oops! We couldnâ€™t find a Dropbox account matching that email. <a>Click here to create one.</a>"},{a:e=>r.default.createElement("a",{className:"third-party-signup-link",href:t},e)});this.setState({localErrors:Object.assign(Object.assign({},this.state.localErrors),{googleLogin:s})})}else e.localized_error?c.Notify.error(e.localized_error):c.Notify.error(b.intl.formatMessage({id:"bLA3rA",defaultMessage:"There was a problem completing this request."}));else if("tos_required"===e.err_msg){const t=new p.URI({path:"/account/complete_registration_page"}).updateQuery({finish_web_auth:"true",remember_me:e.remember_me.toString(),cont:this.props.continuationUrl||"/"});o.redirect(t.toString())}else if("tfa_required"===e.err_msg){const s=new p.URI({path:"/verify_code"}).updateQuery({cont:t,remember_me:e.remember_me.toString(),pair_user:e.pair_user.toString()});o.redirect(s.toString())}else if("enable_twofactor_required"===e.err_msg){const s=new p.URI({path:"/twofactor"}).updateQuery({cont:t,remember_me:e.remember_me.toString(),pair_user:e.pair_user.toString()});o.redirect(s.toString())}else if("not_verified"===e.err_msg){const s=new p.URI({path:"/show_password_form"}).updateQuery({cont:t,remember_me:e.remember_me.toString(),pair_user:e.pair_user.toString()});o.redirect(s.toString())}else if("email_not_verified"===e.err_msg){const t=b.intl.formatMessage({id:"S6RuBm",defaultMessage:"Before you can sign in, youâ€™ll need to verify your account with Google {email}"},{email:e.profile.email});c.Notify.error(new l.HTML(`<span>${t}</span>`),30)}else e.localized_error?c.Notify.error(e.localized_error):c.Notify.error(b.intl.formatMessage({id:"bLA3rA",defaultMessage:"There was a problem completing this request."})),"google_login_not_allowed"!==e.err_msg&&"sso_required"!==e.err_msg||(this.setState({email:e.profile.email}),this.ssoChecker.checkSsoState(e.profile.email,this.onSsoStateUpdate))})),this.onGoogleLoginClick=()=>{this.handleLoginFormEvent(v.LoginFormEvent.GOOGLE_LOGIN_CLICK),this.setState({localErrors:{}}),L.AuthAMPLogger.logLoginAttempt(L.AuthType.GOOGLE,this.props.type),L.GoogleUXAnalyticsLogger.logLoginStart();const e=!!this.props.googleLoginProps&&!1!==this.props.googleLoginProps.popup;(new C.ProfileServicesLinkingHandler).auth_service_login_web(I.default.GOOGLE,this.handleGoogleCallback,"login_form",e?C.AuthWindowOption.POP_UP:C.AuthWindowOption.REDIRECT,this.state.rememberMe,this.props.continuationUrl||"/","pairing"===this.props.type)},this.handleAppleCallback=e=>s.__awaiter(this,void 0,void 0,(function*(){L.AuthAMPLogger.logThirdPartyLoginResponse(L.AuthType.APPLE,this.props.type,e.success,e.err_msg),L.AppleUXAnalyticsLogger.logLoginResponse(e);let t=(0,N.getFedrampRedirectUrlIfApplicable)(e.is_fedramp_user||!1,this.props.continuationUrl||"/");if(e.profile&&!R.isTest()&&(yield this.credentialsFormComponent.getFingerprintJsComponent().getWrappedComponent().postFPJSTokenAndLog(e.profile.email)),e.success)this.handleLoginFormEvent(v.LoginFormEvent.APPLE_LOGIN_SUCCESS),!1!==this.props.canRedirect?(c.Notify.success(b.intl.formatMessage({id:"ZJmJez",defaultMessage:"Sign in successful! Your browser will be redirected in a few seconds."})),o.redirect(t)):e.is_fedramp_user&&!this.props.forceOnLoginSuccess?(t=(0,N.getFedrampRedirectUrlIfApplicable)(!0,this.props.continuationUrl||o.get_href()),o.redirect(t)):this.props.onLoginSuccess&&this.props.onLoginSuccess({display_name:e.display_name,id:e.user_id,email:e.profile.email,is_fedramp_user:e.is_fedramp_user});else if("no_email_in_response"===e.err_msg){const e=b.intl.formatMessage({id:"oFA/9f",defaultMessage:"Sign in failed. If youâ€™d like to sign in with Apple again, <a>see how in our help center</a>. You could also sign in with your Dropbox account email and password."},{a:e=>`<a href="/help/accounts-billing/settings-sign-in/apple-sign-in-error">${e}</a>`});c.Notify.error(new l.HTML(`<span>${e}</span>`),30)}else if("tfa_required"===e.err_msg){const s=new p.URI({path:"/verify_code"}).updateQuery({cont:t,remember_me:e.remember_me.toString(),pair_user:e.pair_user.toString()});o.redirect(s.toString())}else if("enable_twofactor_required"===e.err_msg){const s=new p.URI({path:"/twofactor"}).updateQuery({cont:t,remember_me:e.remember_me.toString(),pair_user:e.pair_user.toString()});o.redirect(s.toString())}else if("requires_password_on_first_link"===e.err_msg){const s=new p.URI({path:"/show_password_form"}).updateQuery({cont:t,remember_me:e.remember_me.toString(),pair_user:e.pair_user.toString()});o.redirect(s.toString())}else if("emails_do_not_match"===e.err_msg){const t=b.intl.formatMessage({id:"8cKJMG",defaultMessage:"We couldnâ€™t find a Dropbox account matching the email {email}. <a1>Sign up for a new account</a1> or <a2>get help signing in</a2> to an existing account."},{a1:e=>`<a href="/individual/plans-comparison?_tk=sia_nomatch_plan_web">${e}</a1>`,a2:e=>`<a href="/help/accounts-billing/settings-sign-in/sign-in-with-apple?_tk=sia_nomatch_help_web">${e}</a2>`,email:e.profile.email});c.Notify.error(new l.HTML(`<span>${t}</span>`),30)}else e.localized_error?c.Notify.error(e.localized_error):c.Notify.error(b.intl.formatMessage({id:"bLA3rA",defaultMessage:"There was a problem completing this request."})),"apple_login_not_allowed"===e.err_msg&&(this.setState({email:e.profile.email}),this.ssoChecker.checkSsoState(e.profile.email,this.onSsoStateUpdate))})),this.onAppleLoginClick=()=>{this.handleLoginFormEvent(v.LoginFormEvent.APPLE_LOGIN_CLICK),this.setState({localErrors:{}}),L.AuthAMPLogger.logLoginAttempt(L.AuthType.APPLE,this.props.type),L.AppleUXAnalyticsLogger.logLoginStart();const e=!!this.props.appleLoginProps&&!1!==this.props.appleLoginProps.popup;(new C.ProfileServicesLinkingHandler).auth_service_login_web(I.default.APPLE,this.handleAppleCallback,"login_form",e?C.AuthWindowOption.POP_UP:C.AuthWindowOption.REDIRECT,this.state.rememberMe,this.props.continuationUrl||"/","pairing"===this.props.type)},this.credentialsFormData=()=>{const e=Object.assign(Object.assign(Object.assign({login_email:this.state.email,cont:this.props.continuationUrl||"/",remember_me:this.state.rememberMe},this.credentialsFormComponent.getCaptchaResponses()),this.props.additionalData),{origin:this.props.origin,tluid:this.props.targetLinkedUserId});if(void 0===this.props.encryptionOptions)return Promise.reject(new Error("Must provide encryption options"));const t=this.state.ssoState===v.SsoState.OFF?this.state.password:"";return(0,y.wrapPassword)(t,this.props.encryptionOptions).then(t=>(e.encrypted_password=t,Promise.resolve(e)))},this.handleLoginSuccess=e=>s.__awaiter(this,void 0,void 0,(function*(){if(this.handleLoginFormEvent(v.LoginFormEvent.LOGIN_IMMEDIATE_SUCCESS,{userInfo:e}),this.state.didEnterIncorrectPassword&&(yield f.updateDropboxPasswordsEligibility("incorrect_password")),!1!==this.props.canRedirect){const t=(0,N.getFedrampRedirectUrlIfApplicable)(e.is_fedramp_user||!1,e.cont_override||this.props.continuationUrl||"/");return o.redirect(t)}if(e.is_fedramp_user&&!this.props.forceOnLoginSuccess){const e=(0,N.getFedrampRedirectUrlIfApplicable)(!0,this.props.continuationUrl||o.get_href());return o.redirect(e)}return this.props.onLoginSuccess?this.props.onLoginSuccess(e):o.redirect("/")})),this.handleSuccessResponse=e=>{switch(this.setState({isSubmitting:!1}),L.AuthAMPLogger.logCredentialsLoginResponse(this.props.type,e.status),L.EmailAuthUXAnalyticsLogger.logLoginResponse(e),e.status){case v.LoginResponseStatus.ERROR:const t=e.html_response?new l.HTML(e.message):e.message;return c.Notify.error(t);case v.LoginResponseStatus.EXPIRED:return o.redirect(e.cont);case v.LoginResponseStatus.OK:const s={id:e.id,email:e.email,display_name:e.display_name,locale:e.locale,is_fedramp_user:e.is_fedramp_user,cont_override:e.cont_override};this.handleLoginSuccess(s);break;case v.LoginResponseStatus.PASSWORD_EXPIRED:return this.setState({localErrors:Object.assign(Object.assign({},this.state.localErrors),{email:{message_text:b.intl.formatMessage({id:"3EEu7s",defaultMessage:"The password of the account associated with this email has expired. Please login to this account and update its password before pairing."})}})});case v.LoginResponseStatus.RATELIMIT:return this.setState({localErrors:Object.assign(Object.assign({},this.state.localErrors),{email:{message_text:b.intl.formatMessage({id:"7k/CMy",defaultMessage:"Youâ€™ve tried to log in too many times. Please try again in a few minutes."})}})});case v.LoginResponseStatus.TWOFACTOR_REQUIRED:case v.LoginResponseStatus.TOS_SIGNATURE_REQUIRED:return o.redirect(e.cont);case v.LoginResponseStatus.TWOFACTOR:e.checkpoint_token&&this.setState({checkpointToken:e.checkpoint_token}),e.use_email_2fa?this.setState({primaryTwoFactorType:v.TwoFactorType.EMAIL,currentStep:M.EMAIL_2FA}):e.u2f_challenge&&O.canUseAuthenticator(this.generateU2fRequest(e.u2f_challenge))?(this.setState({primaryTwoFactorType:v.TwoFactorType.SEC_KEY,currentStep:M.SECKEY_2FA}),e.last_two_digits?this.setState({lastTwoDigits:e.last_two_digits,secondaryTwoFactorType:v.TwoFactorType.SMS}):this.setState({secondaryTwoFactorType:v.TwoFactorType.AUTHENTICATOR}),this.kickOffU2f(e.u2f_challenge)):e.last_two_digits?this.setState({primaryTwoFactorType:v.TwoFactorType.SMS,lastTwoDigits:e.last_two_digits,secondaryTwoFactorType:void 0,currentStep:M.PHONE_2FA}):this.setState({primaryTwoFactorType:v.TwoFactorType.AUTHENTICATOR,lastTwoDigits:void 0,secondaryTwoFactorType:void 0,currentStep:M.AUTHENTICATOR_2FA});break;case v.LoginResponseStatus.SSO:return o.unsafeRedirect(e.sso_url);case v.LoginResponseStatus.PASSWORD_DECRYPTION_ERROR:return o.redirect(e.cont)}},this.handleServerErrors=e=>{if(L.AuthAMPLogger.logCredentialsLoginResponse(this.props.type,e.funcaptcha_response?"funcaptcha_response":"form_error"),this.credentialsFormComponent.handleCaptchaErrors(e))return void setTimeout(()=>{this.isCaptchaReady||(0,d.notifyCaptchaNotLoaded)()},1e4);L.EmailAuthUXAnalyticsLogger.logLoginError();const t={};e.login_email?t.email=e.login_email:t.email=void 0,e.login_password?t.password=e.login_password:t.password=void 0,e["failed-login-invalid-email-password"]?(t.login=b.intl.formatMessage({id:"kfg1Pg",defaultMessage:"Oops! It looks like you may have forgotten your password. <a>Click here to reset it.</a>"},{a:e=>r.default.createElement("a",{href:"/forgot"},e)}),this.setState({didEnterIncorrectPassword:!0})):t.login=void 0,e["account-is-disabled"]&&e.login_email&&e.login_email.message_text&&this.props.onCreateNewAccountClick&&this.props.onReRegisterClick&&(t.styledEmailError=t=>(L.AuthUXAnalyticsLogger.logDisabledErrorDismissed(),r.default.createElement(A.LoginEmailDisabledErrorBanner,{disabledErrorMessage:e.login_email.message_text,onCreateNewAccount:this.props.onCreateNewAccountClick,onReRegister:()=>this.props.onReRegisterClick(this.state.email),onRequestClose:()=>{L.AuthUXAnalyticsLogger.logDisabledErrorDismissed(),this.setState({localErrors:Object.assign(Object.assign({},this.state.localErrors),{styledEmailError:void 0})})},id:t.id})),t.email=void 0),e["account-is-recoverable"]&&e.login_email&&e.login_email.message_text&&this.props.onCreateNewAccountClick&&(t.styledEmailError=t=>(L.AuthUXAnalyticsLogger.logRecoverableErrorDismissed(),r.default.createElement(A.LoginEmailRecoverableErrorBanner,{onCreateNewAccount:this.props.onCreateNewAccountClick,onRequestClose:()=>{L.AuthUXAnalyticsLogger.logRecoverableErrorDismissed(),this.setState({localErrors:Object.assign(Object.assign({},this.state.localErrors),{styledEmailError:void 0})})},recoverableErrorMessage:e.login_email.message_text,id:t.id})),t.email=void 0),this.setState({localErrors:t}),this.setState({isSubmitting:!1})},this.onCredentialsFormSubmit=()=>s.__awaiter(this,void 0,void 0,(function*(){L.EmailAuthUXAnalyticsLogger.logLoginStart(),this.setState({isSubmitting:!0}),this.state.email&&!R.isTest()&&(yield this.credentialsFormComponent.getFingerprintJsComponent().getWrappedComponent().postFPJSTokenAndLog(this.state.email)),this.credentialsFormData().then(e=>{f.submitCredentialsForm(this.props.type,e).then(this.handleSuccessResponse).catch(this.handleServerErrors)}).catch(e=>{let t,s;e.isBrowserNotSupported?(t="user-error",s=b.intl.formatMessage({id:"rWb8d2",defaultMessage:"Dropbox doesnâ€™t support your browser. For a better experience, upgrade to the latest version of a modern browser like Chrome, Firefox, Edge, or Safari."})):(t="critical",s=b.intl.formatMessage({id:"dNlIBC",defaultMessage:"There was a problem completing this request."})),(0,n.reportException)({err:e,severity:t,tags:["react-login-form"]}),this.setState({isSubmitting:!1}),c.Notify.error(s)})})),this.onLoginClick=e=>{e.preventDefault(),L.AuthAMPLogger.logLoginAttempt(L.AuthType.CREDENTIALS,this.props.type),this.handleLoginFormEvent(v.LoginFormEvent.LOGIN_CLICK),this.credentialsFormComponent.submitRecaptcha()},this.handleResendCodeSuccess=e=>{let t;switch(e){case v.TwoFactorResendResponse.OK:return c.Notify.success(b.intl.formatMessage({id:"vdqTup",defaultMessage:"We sent you a code. It may take a few minutes to arrive."}));case v.TwoFactorResendResponse.RATELIMIT:t=b.intl.formatMessage({id:"7k/CMy",defaultMessage:"Youâ€™ve tried to log in too many times. Please try again in a few minutes."});break;case v.TwoFactorResendResponse.UNREACHABLE:t=b.intl.formatMessage({id:"G6HUee",defaultMessage:"We couldnâ€™t reach your phone number. Are you sure itâ€™s correct?"});break;case v.TwoFactorResendResponse.EXPIRED:t=b.intl.formatMessage({id:"l5AyQn",defaultMessage:"Sorry, your phone code has expired. Please log in again."});break;case v.TwoFactorResendResponse.BADCARRIER:t=b.intl.formatMessage({id:"ffjRA4",defaultMessage:"Unfortunately, your carrier isnâ€™t supported at this time."});break;case v.TwoFactorResendResponse.INVALIDNUMBER:t=b.intl.formatMessage({id:"1P05hM",defaultMessage:"That isnâ€™t a valid phone number."});break;case v.TwoFactorResendResponse.NOTAMOBILE:t=b.intl.formatMessage({id:"aI/ARD",defaultMessage:"That phone number doesnâ€™t appear to be a valid mobile number."});break;default:return c.Notify.error(b.intl.formatMessage({id:"bLA3rA",defaultMessage:"There was a problem completing this request."}))}this.setState({localErrors:Object.assign(Object.assign({},this.state.localErrors),{twoFactor:{message_text:t}})})},this.resendCode=()=>{var e,t,s,a;const r=f.resendTwoFactorCode(null!==(t=null===(e=this.props.additionalData)||void 0===e?void 0:e.backup)&&void 0!==t&&t,null!==(a=null===(s=this.props.additionalData)||void 0===s?void 0:s.mobile_push)&&void 0!==a&&a);r.then(this.handleResendCodeSuccess),r.catch(()=>{c.Notify.error(b.intl.formatMessage({id:"bLA3rA",defaultMessage:"There was a problem completing this request."}))})},this.handleTwoFactorSuccess=e=>{switch(L.AuthAMPLogger.log2faResponse(this.props.type,e.status),e.status){case v.LoginResponseStatus.OK:this.state.currentStep===M.SECKEY_2FA&&this.setState({securityKeyState:v.SecurityKeyState.FOUND});const t={id:e.id,email:e.email,display_name:e.display_name,locale:e.locale,is_fedramp_user:e.is_fedramp_user,cont_override:e.cont_override};this.handleLoginSuccess(t);break;case v.LoginResponseStatus.ERROR:c.Notify.error(e.message);break;case v.LoginResponseStatus.REQUIRES_ROLE:case v.LoginResponseStatus.EXPIRED:this.setState({localErrors:Object.assign(Object.assign({},this.state.localErrors),{email:{message_text:e.message}}),currentStep:M.CREDENTIALS_OR_SSO});break;case v.LoginResponseStatus.INVALID_CREDENTIALS:this.setState({localErrors:Object.assign(Object.assign({},this.state.localErrors),{password:{message_text:e.message}}),currentStep:M.CREDENTIALS_OR_SSO});break;default:c.Notify.error(b.intl.formatMessage({id:"bLA3rA",defaultMessage:"There was a problem completing this request."}))}},this.twoFactorFormData=()=>{const e=Object.assign({remember_me:this.state.rememberMe,cont:this.props.continuationUrl||"/",code:this.state.twoFactorCode,trusted:this.state.trusted},this.props.additionalData);return this.state.checkpointToken?Object.assign({checkpoint_token:this.state.checkpointToken},e):e},this.submitTwoFactor=()=>{this.setState({isSubmitting:!0});const e=f.submitTwoFactorForm(this.props.type,this.twoFactorFormData());e.then(this.handleTwoFactorSuccess),e.catch(e=>{L.AuthAMPLogger.log2faResponse(this.props.type,e.u2f?"u2f_error":e.code?"code_error":"unknown"),this.state.currentStep===M.SECKEY_2FA&&e.u2f?this.setState({localErrors:Object.assign(Object.assign({},this.state.localErrors),{securityKey:e.u2f.message_text}),securityKeyState:v.SecurityKeyState.NOT_FOUND}):e.code?this.setState({localErrors:Object.assign(Object.assign({},this.state.localErrors),{twoFactor:e.code})}):c.Notify.error(b.intl.formatMessage({id:"bLA3rA",defaultMessage:"There was a problem completing this request."}))}),e.finally(()=>{this.setState({isSubmitting:!1})})},this.onPhone2FASubmit=e=>{e.preventDefault(),this.submitTwoFactor()},this.onAuthenticator2FASubmit=e=>{e.preventDefault(),this.submitTwoFactor()},this.generateU2fRequest=e=>{const t=JSON.parse(e),s={challenge_id:t.challenge_id};for(const e of Object.keys(O.PROTOCOLS))s[e]=t[e]&&JSON.parse(t[e]);return s},this.kickOffU2f=e=>s.__awaiter(this,void 0,void 0,(function*(){const t=this.generateU2fRequest(e);if(O.canUseAuthenticator(t))try{const e=yield O.sign(t);this.state.currentStep===M.SECKEY_2FA&&this.setState({twoFactorCode:JSON.stringify(e)},()=>this.submitTwoFactor())}catch(e){this.state.currentStep===M.SECKEY_2FA&&this.setState({securityKeyState:v.SecurityKeyState.NOT_FOUND}),(0,i.assert)(!1,`U2F Error - ${e}`,{tags:["react-login-form","u2f"]})}})),this.switch2FA=()=>{let e;(0,i.assert)(this.state.primaryTwoFactorType===v.TwoFactorType.SEC_KEY,"Unexpected two factor choice switch",{tags:["react-login-form"]}),this.state.secondaryTwoFactorType===v.TwoFactorType.SMS?(e=M.PHONE_2FA,this.resendCode()):e=M.AUTHENTICATOR_2FA,this.setState({twoFactorCode:"",primaryTwoFactorType:this.state.secondaryTwoFactorType,secondaryTwoFactorType:void 0,currentStep:e})},this.onRetryU2f=()=>{this.setState({securityKeyState:v.SecurityKeyState.LOADING});const e=f.retryU2fAuthentication();e.then(this.kickOffU2f),e.catch(()=>{this.setState({securityKeyState:v.SecurityKeyState.NOT_FOUND}),c.Notify.error(b.intl.formatMessage({id:"bLA3rA",defaultMessage:"There was a problem completing this request."}))})},this.onCaptchaReady=()=>{this.isCaptchaReady=!0},(0,i.assert)(!1!==e.canRedirect||!!e.onLoginSuccess,"Need an on login success handler if we cannot redirect the user",{tags:["react-login-form"]}),this.ssoChecker=new S.SsoStateChecker,this.isCaptchaReady=!1;let a=M.CREDENTIALS_OR_SSO,m=void 0,g=void 0,h=void 0;e.twoFactorOnlyProps&&(e.twoFactorOnlyProps.u2fChallenge&&!(null===(t=e.additionalData)||void 0===t?void 0:t.backup)&&O.canUseAuthenticator(this.generateU2fRequest(e.twoFactorOnlyProps.u2fChallenge))?(a=M.SECKEY_2FA,m=v.TwoFactorType.SEC_KEY,e.twoFactorOnlyProps.lastTwoDigits?(g=v.TwoFactorType.SMS,h=e.twoFactorOnlyProps.lastTwoDigits):g=v.TwoFactorType.AUTHENTICATOR):e.twoFactorOnlyProps.lastTwoDigits?(a=M.PHONE_2FA,m=v.TwoFactorType.SMS,h=e.twoFactorOnlyProps.lastTwoDigits):(a=M.AUTHENTICATOR_2FA,m=v.TwoFactorType.AUTHENTICATOR)),this.state={currentStep:a,email:e.emailProps&&e.emailProps.initialValue||"",isSubmitting:!1,lastTwoDigits:h,localErrors:{},password:"",primaryTwoFactorType:m,secondaryTwoFactorType:g,rememberMe:e.rememberMeCheckboxProps&&e.rememberMeCheckboxProps.checked||!1,securityKeyState:v.SecurityKeyState.LOADING,ssoState:v.SsoState.OFF,trusted:e.twoFactorTrustCheckboxProps&&e.twoFactorTrustCheckboxProps.checked||!1,twoFactorCode:"",checkpointToken:void 0,shouldDisableForm:!0,didEnterIncorrectPassword:!1}}handleLoginFormEvent(e,t){(0,d.pushMarketingEvent)(e,this.props.pushConversionDataReadyMarketingEvent),this.props.onLoginFormEvent&&this.props.onLoginFormEvent(e,t)}componentDidMount(){this.setState({shouldDisableForm:!1}),this.listenForContextChanges(),this.props.twoFactorOnlyProps||L.AuthAMPLogger.logLoginIntent(this.props.type),this.props.twoFactorOnlyProps&&this.props.twoFactorOnlyProps.u2fChallenge&&this.state.currentStep===M.SECKEY_2FA&&this.kickOffU2f(this.props.twoFactorOnlyProps.u2fChallenge),this.state.email&&this.ssoChecker.checkSsoState(this.state.email,this.onSsoStateUpdate)}get shouldDisableForm(){return!!this.props.disabled||this.state.shouldDisableForm}get supportsCaptcha(){return!this.props.hideCredentialFields&&!["multi","pairing","cli_link_nonce"].includes(this.props.type)}render(){var e,t,s,i;let o;switch(this.state.currentStep){case M.CREDENTIALS_OR_SSO:o=r.default.createElement(E.LoginCredentialsForm,{ref:this.setCredentialsFormComponent,disabled:this.shouldDisableForm,emailError:this.state.localErrors.email,styledEmailError:this.state.localErrors.styledEmailError,emailProps:this.props.emailProps||{},emailValue:this.state.email,forgotPasswordProps:this.props.forgotPasswordProps||{},googleLoginError:this.state.localErrors.googleLogin,googleLoginProps:this.props.googleLoginProps,appleLoginError:this.state.localErrors.appleLogin,appleLoginProps:this.props.appleLoginProps,hideCredentialFields:this.props.hideCredentialFields||!1,hideHelp:this.props.hideHelp||!1,hideRememberMe:this.props.hideRememberMe||!1,isPaperLogin:this.props.isPaperLogin||!1,isSubmitting:this.state.isSubmitting,loginButtonProps:this.props.loginButtonProps||{},loginError:this.state.localErrors.login,maestroStyle:this.props.maestroStyle||!1,onGoogleLoginClick:this.onGoogleLoginClick,onAppleLoginClick:this.onAppleLoginClick,onInputChange:this.onInputChange,onLoginClick:this.onLoginClick,openLinksInNewTab:!!this.props.openLinksInNewTab,onSsoChangeClick:this.onSsoChangeClick,onSubmit:this.onCredentialsFormSubmit,onCaptchaReady:this.onCaptchaReady,passwordError:this.state.localErrors.password,passwordProps:this.props.passwordProps||{},passwordValue:this.state.password,persistLabel:!!this.props.persistLabel,rememberMeProps:this.props.rememberMeCheckboxProps||{},rememberMeValue:this.state.rememberMe,showNaviSiteLogin:!!this.props.showNaviSiteLogin,ssoState:this.state.ssoState,supportsCaptcha:this.supportsCaptcha,variant:this.props.variant||u.AuthFormVariant.STANDARD,googleOneTapVariant:this.props.googleOneTapVariant,gsiState:this.props.gsiState});break;case M.PHONE_2FA:o=r.default.createElement(h.Phone2FAForm,{continuationUrl:this.props.continuationUrl,displayHeader:null!==(e=this.props.twoFactorDisplayHeader)&&void 0!==e&&e,error:this.state.localErrors.twoFactor,hideHelp:this.props.hideHelp||!1,hideTrustCheckbox:this.props.hideRememberMe||!1,inlineSubmit:void 0===this.props.twoFactorSubmitButtonInline||this.props.twoFactorSubmitButtonInline,lastTwoDigits:this.state.lastTwoDigits||"",maestroStyle:this.props.maestroStyle||!1,onInputChange:this.onInputChange,onResendCodeClick:this.resendCode,onSubmit:this.onPhone2FASubmit,rememberMe:this.state.rememberMe,trusted:this.state.trusted,trustTooltipPosition:this.props.twoFactorTrustCheckboxProps&&this.props.twoFactorTrustCheckboxProps.tooltipPosition,value:this.state.twoFactorCode,variant:this.props.variant||u.AuthFormVariant.STANDARD});break;case M.EMAIL_2FA:o=r.default.createElement(g.Email2FAForm,{displayHeader:null!==(t=this.props.twoFactorDisplayHeader)&&void 0!==t&&t,email:this.state.email,error:this.state.localErrors.twoFactor,inlineSubmit:void 0===this.props.twoFactorSubmitButtonInline||this.props.twoFactorSubmitButtonInline,maestroStyle:this.props.maestroStyle||!1,onInputChange:this.onInputChange,onSubmit:this.onPhone2FASubmit,value:this.state.twoFactorCode,variant:this.props.variant||u.AuthFormVariant.STANDARD,onResendCodeClick:this.resendCode});break;case M.AUTHENTICATOR_2FA:o=r.default.createElement(m.Authenticator2FAForm,{continuationUrl:this.props.continuationUrl,displayHeader:null!==(s=this.props.twoFactorDisplayHeader)&&void 0!==s&&s,error:this.state.localErrors.twoFactor,hideHelp:this.props.hideHelp||!1,hideTrustCheckbox:this.props.hideRememberMe||!1,inlineSubmit:void 0===this.props.twoFactorSubmitButtonInline||this.props.twoFactorSubmitButtonInline,maestroStyle:this.props.maestroStyle||!1,onInputChange:this.onInputChange,onSubmit:this.onAuthenticator2FASubmit,rememberMe:this.state.rememberMe,trusted:this.state.trusted,trustTooltipPosition:this.props.twoFactorTrustCheckboxProps&&this.props.twoFactorTrustCheckboxProps.tooltipPosition,value:this.state.twoFactorCode,variant:this.props.variant||u.AuthFormVariant.STANDARD});break;case M.SECKEY_2FA:o=r.default.createElement(_.SecKey2FAForm,{displayHeader:null!==(i=this.props.twoFactorDisplayHeader)&&void 0!==i&&i,error:this.state.localErrors.securityKey,hideTrustCheckbox:this.props.hideRememberMe||!1,maestroStyle:this.props.maestroStyle||!1,onChange2FA:this.switch2FA,onInputChange:this.onInputChange,onRetry:this.onRetryU2f,trusted:this.state.trusted,trustTooltipPosition:this.props.twoFactorTrustCheckboxProps&&this.props.twoFactorTrustCheckboxProps.tooltipPosition,secondaryTwoFactorType:this.state.secondaryTwoFactorType,securityKeyState:this.state.securityKeyState,variant:this.props.variant||u.AuthFormVariant.STANDARD})}const n=(0,a.default)("login-form-container",this.props.variant,this.props.className,{"login-form-container--centered":this.props.centered,"login-form-container--maestro":this.props.maestroStyle});return r.default.createElement("div",{className:n},r.default.createElement("div",{className:"regular-login-forms"},o))}}t.TestOnlyLoginFormComponent=P,P.displayName="LoginFormComponent",t.LoginForm=(0,T.requireCssWithComponent)(P,["/static/metaserver/static/css/components/exp_cards-vfls5BO1G.css","/static/metaserver/static/css/components/login_form-vfl2U1j84.css","/static/metaserver/static/css/components/button-vfl7d2xHj.css","/static/metaserver/static/css/legacy_packages/components-vflC1mY9W.css","/static/metaserver/static/css/login_or_register-vflxEyRx5.css","/static/metaserver/static/css/scooter/scooter-scoped-vflEOlF6E.css","/static/metaserver/static/css/spectrum/index.web-vflJy4G-t.css","/static/metaserver/static/css/dig-components/index.web-vflVpv-hZ.css","/static/typescript/component_libraries/dwg-components/src/index.web-vfl4Z0Fer.css","/static/metaserver/static/css/recaptcha_challenge-vflrcf67y.css","/static/metaserver/static/css/recaptcha_v2_challenge-vflYEW-GO.css"])})),define("metaserver/static/js/auth/login/google_login_button",["require","exports","tslib","react","classnames","metaserver/static/js/core/i18n","metaserver/static/js/auth/login/login_error","typescript/component_libraries/dwg-components/src/components/dwg-sso-button/index"],(function(e,t,s,a,r,i,o,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GoogleLoginButton=void 0,a=s.__importDefault(a),r=s.__importDefault(r);t.GoogleLoginButton=e=>{const t=e.buttonProps||{},s=t.text||i.intl.formatMessage({id:"SgtygT",defaultMessage:"Sign in with Google"});return a.default.createElement("div",{className:"login-form-container__google-div"},a.default.createElement(n.DWGSSOButton,{onClick:e.onClick,classes:(0,r.default)("auth-google"),disabled:e.disabled||t.disabled,service:"google",width:"full",dataUxaLog:"google_login_start"},s),e.error&&a.default.createElement(o.LoginError,{className:"google-login-error",message:e.error}))}})),define("metaserver/static/js/auth/login/login_error",["require","exports","tslib","react","classnames"],(function(e,t,s,a,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LoginError=void 0,a=s.__importDefault(a),r=s.__importDefault(r);t.LoginError=e=>{const t=(0,r.default)("c-card","c-card--error",e.className);return a.default.createElement("div",{className:t},e.message)}})),define("metaserver/static/js/auth/login/sso_utils",["require","exports","tslib","metaserver/static/js/auth/login/api","metaserver/static/js/auth/login/types"],(function(e,t,s,a,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SsoStateChecker=void 0,a=s.__importStar(a);const i=/^[^@\s]+@[^@\s]+\.[A-Za-z]{2,}$/;t.SsoStateChecker=class{constructor(){this.shouldCheckSsoState=e=>e.match(i),this.checkSsoState=(e,t)=>{this.shouldCheckSsoState(e)?this.CACHE[e]?t(e,this.CACHE[e]):this.INFLIGHT[e]||(this.INFLIGHT[e]=!0,a.checkSsoState(e).then(s=>{switch(s.user_sso_state){case"optional":this.CACHE[e]=r.SsoState.OPTIONAL;break;case"required":this.CACHE[e]=r.SsoState.REQUIRED;break;default:this.CACHE[e]=r.SsoState.OFF}t(e,this.CACHE[e])}).finally(()=>{delete this.INFLIGHT[e]})):t(e,r.SsoState.OFF)},this.CACHE={},this.INFLIGHT={}}}})),define("metaserver/static/js/auth/login/types",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LoginFormEvent=t.TwoFactorResendResponse=t.LoginResponseStatus=t.SsoState=t.SecurityKeyState=t.TwoFactorType=t.LoginRole=void 0,(function(e){e.ROLE_WORK="work",e.ROLE_PERSONAL="personal",e.ROLE_PHOTOS="photos",e.ROLE_BOTH="both"})(t.LoginRole||(t.LoginRole={})),(function(e){e[e.EMAIL=0]="EMAIL",e[e.SMS=1]="SMS",e[e.AUTHENTICATOR=2]="AUTHENTICATOR",e[e.SEC_KEY=3]="SEC_KEY"})(t.TwoFactorType||(t.TwoFactorType={})),(function(e){e[e.LOADING=0]="LOADING",e[e.FOUND=1]="FOUND",e[e.NOT_FOUND=2]="NOT_FOUND"})(t.SecurityKeyState||(t.SecurityKeyState={})),(function(e){e.OFF="off",e.OPTIONAL="optional",e.REQUIRED="required"})(t.SsoState||(t.SsoState={})),(function(e){e.DEVICE_LIMIT="DEVICE_LIMIT",e.OK="OK",e.SSO="SSO",e.TWOFACTOR="TWOFACTOR",e.TWOFACTOR_REQUIRED="TWOFACTOR_REQUIRED",e.RATELIMIT="RATELIMIT",e.PASSWORD_EXPIRED="PASSWORD_EXPIRED",e.EXPIRED="EXPIRED",e.ERROR="ERROR",e.REQUIRES_ROLE="REQUIRES_ROLE",e.INVALID_CREDENTIALS="INVALID_CREDENTIALS",e.PASSWORD_DECRYPTION_ERROR="PASSWORD_DECRYPTION_ERROR",e.TOS_SIGNATURE_REQUIRED="TOS_SIGNATURE_REQUIRED"})(t.LoginResponseStatus||(t.LoginResponseStatus={})),(function(e){e.OK="OK",e.RATELIMIT="RATELIMIT",e.UNREACHABLE="UNREACHABLE",e.EXPIRED="EXPIRED",e.BADCARRIER="BADCARRIER",e.INVALIDNUMBER="BADCARRIER",e.NOTAMOBILE="BADCARRIER"})(t.TwoFactorResendResponse||(t.TwoFactorResendResponse={})),(function(e){e.LOGIN_CLICK="LOGIN_CLICK",e.LOGIN_IMMEDIATE_SUCCESS="LOGIN_IMMEDIATE_SUCCESS",e.GOOGLE_LOGIN_CLICK="GOOGLE_LOGIN_CLICK",e.GOOGLE_LOGIN_SUCCESS="GOOGLE_LOGIN_SUCCESS",e.APPLE_LOGIN_CLICK="APPLE_LOGIN_CLICK",e.APPLE_LOGIN_SUCCESS="APPLE_LOGIN_SUCCESS"})(t.LoginFormEvent||(t.LoginFormEvent={}))})),define("metaserver/static/js/auth/login_or_register/login_register_container",["require","exports","tslib","react","react-intl","classnames","metaserver/static/js/core/i18n","metaserver/static/js/components/ui/css","metaserver/static/js/auth/login_or_register/logging_util","metaserver/static/js/auth/login_or_register/types","metaserver/static/js/auth/login/form","metaserver/static/js/auth/register/form","metaserver/static/js/google_one_tap/lib","dig-components/typography","ts-key-enum"],(function(e,t,s,a,r,i,o,n,l,c,p,u,d,m,g){"use strict";var h;Object.defineProperty(t,"__esModule",{value:!0}),t.TestOnlyStatelessLoginRegisterContainer=t.LoginRegisterContainer=t.StatelessLoginRegisterContainer=t.SwitchLinkLocationEnum=void 0,a=s.__importStar(a),i=s.__importDefault(i),(function(e){e.TOP="top",e.BOTTOM="bottom"})(h=t.SwitchLinkLocationEnum||(t.SwitchLinkLocationEnum={}));const _=(0,r.defineMessages)({registerHeader:{id:"P09UfX",defaultMessage:"Create an account"},loginHeader:{id:"raLp6W",defaultMessage:"Sign in"},switchToRegisterLinkLabel:{id:"91fajJ",defaultMessage:"create an account"},switchToLoginLinkLabel:{id:"/bdGRh",defaultMessage:"log in"}}),f=({switchLinkLabel:e,onSwitchLinkAction:t,switchLinkUxaId:s,hideSwitchOrText:r=!1})=>a.default.createElement("div",{className:"login-register-switch"},!r&&a.default.createElement("span",null,`${o.intl.formatMessage({id:"F1g1bb",defaultMessage:"or"})} `),a.default.createElement(m.Link,{className:"login-register-switch-link",onClick:t,onKeyDown:e=>{e.target instanceof HTMLAnchorElement&&[g.Key.Enter," "].includes(e.key)&&(e.preventDefault(),e.target.click())},hasNoUnderline:!0,href:"#","data-uxa-log":s,role:"button",tabIndex:0},e));f.displayName="SwitchLink";const E=({className:e,hideHeader:t,headerText:s,switchLinkLocation:r,switchLinkLabel:o,onSwitchLinkAction:n,switchLinkUxaId:l,children:c,hideSwitchOrText:p=!1})=>{const u=a.default.createElement(f,{onSwitchLinkAction:n,switchLinkLabel:o,switchLinkUxaId:l,hideSwitchOrText:p});return a.default.createElement("div",{className:(0,i.default)("login-register-part",e)},a.default.createElement("div",{className:"clearfix"},!t&&a.default.createElement("div",{className:"login-register-header"},s),r===h.TOP&&u),c,r===h.BOTTOM&&u)};E.displayName="AuthFormWithHeader";const S=e=>{var t,{switchLinkProps:r={switchLinkLocation:h.TOP},hideHeaders:n=!1,currentMode:l,setLoginRegisterMode:m,gsiState:g}=e,f=s.__rest(e,["switchLinkProps","hideHeaders","currentMode","setLoginRegisterMode","gsiState"]);const{className:S,loginHeader:v,registerHeader:T,loginFormProps:b,registerFormProps:I}=f,{switchLinkLocation:C,switchToRegisterLinkLabel:O,switchToLoginLinkLabel:y}=r,L=(0,i.default)("login-register-container",S,null!==(t=b.variant)&&void 0!==t?t:I.variant,[`login-register-container--link-${C}`]),[N,A]=a.default.useState(void 0),R=!!(null==g?void 0:g.formDisabled),w=a.default.createElement(E,{className:(0,i.default)("login-register-login-part",{"current-form":l===c.Mode.LOGIN,[d.GOOGLE_ONE_TAP_DISABLED_FORM]:R}),hideHeader:n,headerText:null!=v?v:o.intl.formatMessage(_.loginHeader),switchLinkLocation:C,switchLinkLabel:null!=O?O:o.intl.formatMessage(_.switchToRegisterLinkLabel),onSwitchLinkAction:()=>{m(c.Mode.REGISTER),d.GSIEventManager.sendGSIEvent(d.GSIEvent.CONTEXT_CHANGE_SIGNUP)},switchLinkUxaId:"create_an_account_toggle"},a.default.createElement(p.LoginForm,Object.assign({},b,{onCreateNewAccountClick:()=>{A(void 0)},onReRegisterClick:e=>{A(e)},gsiState:g,disabled:R}))),M=a.default.createElement(E,{className:(0,i.default)("login-register-register-part",{"current-form":l===c.Mode.REGISTER,[d.GOOGLE_ONE_TAP_DISABLED_FORM]:R}),hideHeader:n,headerText:null!=T?T:o.intl.formatMessage(_.registerHeader),switchLinkLocation:C,switchLinkLabel:null!=y?y:o.intl.formatMessage(_.switchToLoginLinkLabel),onSwitchLinkAction:()=>{m(c.Mode.LOGIN),d.GSIEventManager.sendGSIEvent(d.GSIEvent.CONTEXT_CHANGE_SIGNIN)},switchLinkUxaId:"log_in_toggle"},a.default.createElement(u.RegisterForm,Object.assign({},I,{onEmailChanged:()=>A(void 0),emailPrefill:N,gsiState:g,disabled:R})));return a.default.createElement("div",{className:L},w,M)};t.TestOnlyStatelessLoginRegisterContainer=S,S.displayName="StatelessLoginRegisterContainerView",t.StatelessLoginRegisterContainer=(0,n.requireCssWithComponent)(S,["/static/metaserver/static/css/components/login_or_register-vflKrrdVi.css","/static/metaserver/static/css/legacy_packages/components-vflC1mY9W.css","/static/metaserver/static/css/components/button-vfl7d2xHj.css","/static/metaserver/static/css/scooter/scooter-scoped-vflEOlF6E.css","/static/metaserver/static/css/recaptcha_challenge-vflrcf67y.css","/static/metaserver/static/css/recaptcha_v2_challenge-vflYEW-GO.css"]);t.LoginRegisterContainer=e=>{const[s,r]=(0,a.useState)(e.defaultRegister?c.Mode.REGISTER:c.Mode.LOGIN);(0,a.useEffect)(()=>(0,l.logAuthIntent)(s),[s]),e.googleOneTapVariant&&["V2"].includes(e.googleOneTapVariant)&&!d.GSIEventManager.getGSIState().isInline&&d.GSIEventManager.sendGSIEvent(d.GSIEvent.USE_INLINE_PROMPT);const[i,o]=(0,a.useState)(d.GSIEventManager.getGSIState()),n=[d.GSIEvent.INITIALIZE_PLATFORM,d.GSIEvent.PROMPT_OPEN,d.GSIEvent.PROMPT_CLOSE,d.GSIEvent.DISPLAY_MOMENT,d.GSIEvent.RESET_DISPLAY_MOMENT],p=[d.GSIEvent.TOS_PROMPT_OPEN,d.GSIEvent.TOS_PROMPT_CLOSE,...n],u=()=>{o(d.GSIEventManager.getGSIState())};return(0,a.useEffect)(()=>(d.GSIEventManager.removeGSIEventListener(p,u),d.GSIEventManager.createGSIEventListener(p,u),()=>{d.GSIEventManager.removeGSIEventListener(p,u)}),[]),a.default.createElement(t.StatelessLoginRegisterContainer,Object.assign({currentMode:s,setLoginRegisterMode:r,gsiState:i},e))},t.LoginRegisterContainer.displayName="LoginRegisterContainer"})),define("metaserver/static/js/auth/login_or_register/logging_util",["require","exports","metaserver/static/js/clean/analytics","metaserver/static/js/clean/auth_event_logger","metaserver/static/js/auth/common/stats","metaserver/static/js/auth/login_or_register/types"],(function(e,t,s,a,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.logModalMiscActivity=t.logModalShown=t.logModalDismissed=t.logAuthIntent=void 0;t.logAuthIntent=e=>{e===i.Mode.REGISTER?a.AuthEventLogger.log_web_signup_intent():a.AuthEventLogger.log_web_login_intent()};t.logModalDismissed=(e,t)=>{e===i.Mode.REGISTER?r.AuthUXAnalyticsLogger.logSignupModalDismissed(t):r.AuthUXAnalyticsLogger.logLoginModalDismissed(t)};t.logModalShown=(e,t,s={})=>{e===i.Mode.REGISTER?r.AuthUXAnalyticsLogger.logSignupModalShown(t,s):r.AuthUXAnalyticsLogger.logLoginModalShown(t,s)};t.logModalMiscActivity=(e,t)=>{const a={auth_google:!0};e===i.LoginOrRegisterKind.IMMEDIATE?s.WebMiscActivityLogger.log("signup_modal-show-upfront",a):e===i.LoginOrRegisterKind.DOWNLOAD&&t===i.DownloadAction.DIRECT_DOWNLOAD&&s.WebMiscActivityLogger.log("signup_modal-show-download",a)}})),define("metaserver/static/js/auth/register/form",["require","exports","tslib","react","metaserver/static/js/core/i18n","metaserver/static/js/core/browser","metaserver/static/js/core/assert","metaserver/static/js/deprecated_ajax/ajax_jquery","metaserver/static/js/auth/common/types","metaserver/static/js/auth/common/utils","metaserver/static/js/auth/register/types","metaserver/static/js/auth/register/view","metaserver/static/js/profile_services/auth_callback_handler","metaserver/static/js/profile_services/profile_services_constants","metaserver/static/js/profile_services/profile_services_link","metaserver/static/js/components/ui/css","metaserver/static/js/clean/web_timing_logger","metaserver/static/js/clean/web_register_logging_data","metaserver/static/js/auth/common/stats","metaserver/static/js/api_v2/noauth_client","metaserver/static/js/core/notify","metaserver/static/js/abuse/fingerprintjs_component"],(function(e,t,s,a,r,i,o,n,l,c,p,u,d,m,g,h,_,f,E,S,v,T){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TestOnlyRegisterFormComponent=t.RegisterForm=t.handleInviteResendImpl=void 0,a=s.__importDefault(a),i=s.__importStar(i),n=s.__importStar(n),m=s.__importDefault(m),T=s.__importStar(T);class b extends a.default.Component{constructor(e){super(e),this.testOnlyGetViewComponent=()=>this.viewComponent,this.setViewComponent=e=>{this.viewComponent=e},this.onClickSignUp=e=>s.__awaiter(this,void 0,void 0,(function*(){e.preventDefault(),this.handleRegisterFormEvent(p.RegisterFormEvent.REGISTER_CLICK),E.AuthAMPLogger.logSignupAttempt(E.AuthType.CREDENTIALS),E.EmailAuthUXAnalyticsLogger.logSignupStart();const t=this.getFormErrors();t.fname||t.email||t.password||t.tos?this.setState({localErrors:t}):(this.viewComponent.getCaptchaComponent().getWrappedComponent().submit(),T.isTest()||(yield this.viewComponent.getFingerprintJsComponent().getWrappedComponent().postFPJSTokenAndLog(this.state.email)))})),this.onSubmit=()=>{this.setState({isSubmitting:!0});const e=this.registerData(),t=this.props.signupUrl||(this.thirdPartySignupInitiated?"/ajax_thirdparty_register":"/ajax_register");n.WebRequest({url:t,type:"POST",data:e,success:(e,t,s)=>{this.handleSuccess(e)},error:(e,t,s)=>{"success"===t?this.handleServerErrors(JSON.parse(s)):this.setState({isSubmitting:!1})}})},this.handleGoogleCallback=e=>s.__awaiter(this,void 0,void 0,(function*(){E.AuthAMPLogger.logSignupResponse(E.AuthType.GOOGLE,e.success,e.err_msg),E.GoogleUXAnalyticsLogger.logSignupResponse(e);const{additionalParams:t={},marketingOptInProps:a={},canRedirect:r}=this.props,o=this.props.googleRegisterProps||{},n=o.signupContinuationUrl||"/",l=o.optimisticLoginContinuationUrl||n,c=(0,f.getWebRegisterLoggingData)();e.profile&&!T.isTest()&&(yield this.viewComponent.getFingerprintJsComponent().getWrappedComponent().postFPJSTokenAndLog(e.profile.email));(0,d.handleRegisterResponse)(e,Object.assign({showMarketingOptIn:!!a.show,registerCont:n,loginCont:l,signupTag:t.signup_tag||"",canRedirect:!1!==r,k:t.k,eh:t.eh,signupEndpoint:this.props.signupEndpoint,inlineRedirect:r?void 0:e=>{const{fname:t,lname:a,email:r}=e,i=s.__rest(e,["fname","lname","email"]);this.setState({fname:t,lname:a,email:r,inlineThirdPartySignupState:i})}},c),void 0,()=>{this.handleRegisterFormEvent(p.RegisterFormEvent.GOOGLE_REGISTER_SUCCESS)},e=>{if(this.handleRegisterFormEvent(p.RegisterFormEvent.REGISTER_IMMEDIATE_SUCCESS,{userInfo:e}),!1!==this.props.canRedirect)i.redirect(l);else if(this.props.onRegisterSuccess)return this.props.onRegisterSuccess(e,e)})})),this.onGoogleRegisterClick=()=>{this.handleRegisterFormEvent(p.RegisterFormEvent.GOOGLE_REGISTER_CLICK),E.AuthAMPLogger.logSignupAttempt(E.AuthType.GOOGLE),E.GoogleUXAnalyticsLogger.logSignupStart();const e=new g.ProfileServicesLinkingHandler,t=this.props.googleRegisterProps||{};let s;s=void 0===t.popup?g.AuthWindowOption.POP_UP:t.popup?g.AuthWindowOption.POP_UP:g.AuthWindowOption.REDIRECT;const a=t.signupContinuationUrl?{kind:"web",cont:t.signupContinuationUrl,remember_me:!1,pair_user:!1}:null;e.auth_service_create_user_if_needed(m.default.GOOGLE,this.handleGoogleCallback,"register_form",s,a)},this.onInputChange=e=>{var t,s;const a={},r=e.currentTarget,{name:i,value:o,checked:n}=r;"fname"===i?a.fname=o:"lname"===i?a.lname=o:"email"===i?(a.email=o,null===(s=(t=this.props).onEmailChanged)||void 0===s||s.call(t)):"password"===i?a.password=o:"tos_agree"===i?a.tosAgree=n:"marketing_opt_in"===i&&(a.marketingOptIn=n),this.setState(a),this.clearFormErrors(a)},this.handleResendClick=e=>{const t=e.target,{email:s,isSendingInvite:a}=this.state;"login-register-resend-invite"===t.className&&I(e,a,s,()=>this.setState({isSendingInvite:!0}),()=>this.setState({isSendingInvite:!1}))},this.onCaptchaReady=()=>{this.isCaptchaReady=!0},(0,o.assert)(!1!==e.canRedirect||!!e.onRegisterSuccess,"Need an on register success handler if we cannot redirect the user",{tags:["react-register-form"]});const{fnameProps:t={},lnameProps:a={},emailProps:r={},tosCheckboxProps:l={},marketingOptInProps:c={}}=e,u=!c.show||!!c.checked;this.state={localErrors:{},isSubmitting:!1,fname:t.initialValue||"",lname:a.initialValue||"",email:e.emailPrefill||r.initialValue||"",password:"",tosAgree:!!l.checked,isSendingInvite:!1,marketingOptIn:u,shouldDisableForm:!0},this.mounted=!1,this.isCaptchaReady=!1}getCurrentEmail(){var e;return null!==(e=this.props.emailPrefill)&&void 0!==e?e:this.state.email}handleServerErrors(e){if(!this.mounted)return;if(E.AuthAMPLogger.logSignupResponse(E.AuthType.CREDENTIALS,!1,e.funcaptcha_response?"funcaptcha_response":"form_error"),this.viewComponent.handleCaptchaErrors(e))return void setTimeout(()=>{this.isCaptchaReady||(0,c.notifyCaptchaNotLoaded)()},1e4);E.EmailAuthUXAnalyticsLogger.logSignupError();const t=Object.assign({},this.state.localErrors),s=Date.now();e.email&&(t.email=e.email,t.email.clientTimestamp=s),e.password&&(t.password=e.password,t.password.clientTimestamp=s),e.lname&&(t.lname=e.lname,t.lname.clientTimestamp=s),e.fname&&(t.fname=e.fname,t.fname.clientTimestamp=s),e.tos_agree&&(t.tos=e.tos_agree,t.tos.clientTimestamp=s),this.setState({localErrors:t}),this.setState({isSubmitting:!1})}handleSuccess(e){if(!this.mounted)return;const t=JSON.parse(e),s={id:t.id,email:t.email,display_name:t.display_name};if(E.AuthAMPLogger.logSignupResponse(E.AuthType.CREDENTIALS,!0,null),E.EmailAuthUXAnalyticsLogger.logSignupResponse(),this.handleRegisterFormEvent(p.RegisterFormEvent.REGISTER_IMMEDIATE_SUCCESS,{userInfo:s}),!1!==this.props.canRedirect){const e=t.force_redirect_url?t.redirect_url:this.props.continuationUrlForNonGoogleSignup||t.redirect_url||"/";i.redirect(e)}else this.props.onRegisterSuccess&&this.props.onRegisterSuccess(s,t);this.setState({isSubmitting:!1})}handleRegisterFormEvent(e,t){(0,c.pushMarketingEvent)(e,this.props.pushConversionDataReadyMarketingEvent),this.props.onRegisterFormEvent&&this.props.onRegisterFormEvent(e,t)}registerData(){const[e,t]=(0,c.getFormattedName)(this.state.fname,this.state.lname,this.props.combinedName),s=i.get_uri().getQuery(),{email:a,password:r,tosAgree:o,marketingOptIn:n,inlineThirdPartySignupState:l}=this.state,{additionalParams:p,thirdPartyInitiatedSignupData:u}=this.props,d=Object.assign({fname:e,lname:t,email:a,tos_agree:o},this.thirdPartySignupInitiated?{}:{password:r}),m=Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({cont:this.props.continuationUrlForNonGoogleSignup,signup_endpoint:this.props.signupEndpoint,demandbase_override:s.demandbase_override,marketing_opt_in:n},d),u||{}),l||{}),this.viewComponent&&this.viewComponent.getCaptchaResponses()||{}),p);return(0,f.setWebRegisterLoggingData)(m)}componentDidUpdate(e){e.emailPrefill!==this.props.emailPrefill&&this.setState({email:this.getCurrentEmail()})}clearFormErrors(e){const t=this.state.localErrors;e.fname&&(t.fname={}),e.lname&&(t.lname={}),e.email&&(t.email={}),e.password&&(t.password={}),e.tosAgree&&(t.tos={}),this.setState({localErrors:t})}getFormErrors(){const e={};if(!this.props.validateClientSide)return e;const t=Date.now();return this.state.fname?e.fname=void 0:e.fname={message_text:r.intl.formatMessage({id:"GlyhO1",defaultMessage:"Please enter your name"}),clientTimestamp:t},this.getCurrentEmail()?e.email=void 0:e.email={message_text:r.intl.formatMessage({id:"I7g4FQ",defaultMessage:"Please enter an email address"}),clientTimestamp:t},this.state.password||this.thirdPartySignupInitiated?e.password=void 0:e.password={message_text:r.intl.formatMessage({id:"LhlWCW",defaultMessage:"Please enter a password"}),clientTimestamp:t},this.state.tosAgree?e.tos=void 0:e.tos={message_text:r.intl.formatMessage({id:"yw3Lbd",defaultMessage:"Please agree to the terms of service"}),clientTimestamp:t},e}get thirdPartySignupInitiated(){return!!this.props.thirdPartyInitiatedSignupData||!!this.state.inlineThirdPartySignupState}componentDidMount(){this.setState({shouldDisableForm:!1}),this.props.markTti&&(0,_.mark_time_to_interactive)(),this.mounted=!0,E.AuthAMPLogger.logSignupIntent(),document.addEventListener("click",this.handleResendClick)}componentWillUnmount(){this.mounted=!1,document.removeEventListener("click",this.handleResendClick)}get shouldDisableForm(){return!!this.props.disabled||this.state.shouldDisableForm}render(){const{marketingOptInProps:e={},variant:t,emailProps:s,maestroStyle:r,className:i,combinedName:o,fnameProps:n,lnameProps:c,passwordProps:p,persistLabel:d,tosCheckboxProps:m,submitButtonProps:g,googleRegisterProps:h,showSplitSignupFlow:_,googleOneTapVariant:f}=this.props;return a.default.createElement(u.RegisterFormView,{ref:this.setViewComponent,variant:t||l.AuthFormVariant.STANDARD,maestroStyle:!!r,disabled:this.shouldDisableForm,className:i,combinedName:!!o,fnameProps:n||{},fnameValue:this.state.fname,fnameError:this.state.localErrors.fname,lnameProps:c||{},lnameValue:this.state.lname,lnameError:this.state.localErrors.lname,emailProps:s||{},emailValue:this.getCurrentEmail(),emailError:this.state.localErrors.email,passwordProps:p||{},passwordValue:this.state.password,passwordError:this.state.localErrors.password,tosCheckboxProps:m||{},tosChecked:this.state.tosAgree,tosError:this.state.localErrors.tos,submitButtonProps:g||{},googleRegisterProps:h,thirdPartyInitiatedSignup:this.thirdPartySignupInitiated,isSubmitting:this.state.isSubmitting,onClickSignUp:this.onClickSignUp,onInputChange:this.onInputChange,onSubmit:this.onSubmit,onCaptchaReady:this.onCaptchaReady,onGoogleRegisterClick:this.onGoogleRegisterClick,showMarketingOptIn:!!e.show,marketingOptInChecked:this.state.marketingOptIn,splitSignupEnabled:_,persistLabel:!!d,googleOneTapVariant:f,gsiState:this.props.gsiState})}}function I(e,t,s,a,i){if(!0===t)return void e.preventDefault();const o=new S.NoAuthApiV2Client;a(),o.ns("team").rpc("logged_out_resend_pending_invite_email",{email:s},{}).then(()=>{v.Notify.success(r.intl.formatMessage({id:"un5VKD",defaultMessage:"Invite resent to {email}"},{email:s})),i()}).catch(e=>{v.Notify.error(r.intl.formatMessage({id:"yqLGvW",defaultMessage:"Failed to resend invite."})),i()}),e.preventDefault()}t.TestOnlyRegisterFormComponent=b,b.displayName="RegisterFormComponent",t.handleInviteResendImpl=I,t.RegisterForm=(0,h.requireCssWithComponent)(b,["/static/metaserver/static/css/login_or_register-vflxEyRx5.css","/static/metaserver/static/css/components/login_form-vfl2U1j84.css","/static/metaserver/static/css/components/button-vfl7d2xHj.css","/static/metaserver/static/css/dig-components/index.web-vflVpv-hZ.css","/static/typescript/component_libraries/dwg-components/src/index.web-vfl4Z0Fer.css"])})),define("metaserver/static/js/auth/register/google_register_button",["require","exports","tslib","classnames","react","metaserver/static/js/core/i18n"],(function(e,t,s,a,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GoogleRegisterButton=void 0,a=s.__importDefault(a),r=s.__importDefault(r);t.GoogleRegisterButton=e=>{const t=e.buttonProps||{},s=(0,a.default)("auth-google","button-primary",t.className,{[`button-${t.variant}`]:"standard"!==t.variant}),o=t.text||i.intl.formatMessage({id:"M4SS1n",defaultMessage:"Sign up with Google"});return r.default.createElement("button",{className:s,type:"button",onClick:e.onClick,disabled:e.disabled||t.disabled,"data-uxa-log":"google_signup_start"},r.default.createElement("span",{className:"sign-up-text"},o))}})),define("metaserver/static/js/auth/register/name_fields",["require","exports","tslib","classnames","react","metaserver/static/js/core/i18n","metaserver/static/js/auth/common/inputs/text","metaserver/static/js/auth/common/types","metaserver/static/js/auth/common/utils"],(function(e,t,s,a,r,i,o,n,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RegisterFormNameFields=void 0,a=s.__importDefault(a),r=s.__importDefault(r);t.RegisterFormNameFields=e=>{const t=e.fnameProps||{};if(e.combinedName){const s=(0,a.default)("exp-input-combined-name","clearfix",t.className);return r.default.createElement("div",{className:"register-form__name-fields"},r.default.createElement(o.AuthTextField,{placeholder:t.placeholder||(e.maestroStyle?i.intl.formatMessage({id:"yse7tr",defaultMessage:"Jane Doe"}):i.intl.formatMessage({id:"7raSCH",defaultMessage:"Full name"})),name:"fname",value:e.fnameValue,onChange:e.onInputChange,disabled:e.disabled||t.readonly||!1,label:t.label||(e.maestroStyle?i.intl.formatMessage({id:"7raSCH",defaultMessage:"Full name"}):void 0),error:e.fnameError,maestroStyle:e.maestroStyle,className:s,variant:e.variant,type:n.AuthTextInputType.TEXT}))}const s=e.lnameProps||{},c=["first","text-input__margin-right"],p=["second"];let u=["input-fname",t.className],d=["input-lname",s.className];(0,l.lastNameGoesFirst)()?(d=[...d,...c],u=[...u,...p]):(u=[...u,...c],d=[...d,...p]);const m=r.default.createElement(o.AuthTextField,{className:(0,a.default)(u),name:"fname",value:e.fnameValue,onChange:e.onInputChange,error:e.fnameError,maestroStyle:e.maestroStyle,disabled:e.disabled||t.readonly||!1,label:t.label||(e.maestroStyle?i.intl.formatMessage({id:"flaKkC",defaultMessage:"First name"}):void 0),placeholder:t.placeholder||(e.maestroStyle?i.intl.formatMessage({id:"G3gJf8",defaultMessage:"Jane"}):i.intl.formatMessage({id:"flaKkC",defaultMessage:"First name"})),variant:e.variant,type:n.AuthTextInputType.TEXT,persistLabel:e.persistLabel}),g=r.default.createElement(o.AuthTextField,{className:(0,a.default)(d),name:"lname",value:e.lnameValue,onChange:e.onInputChange,error:e.lnameError,disabled:e.disabled||s.readonly||!1,label:s.label||(e.maestroStyle?i.intl.formatMessage({id:"rew2qC",defaultMessage:"Last name"}):void 0),placeholder:s.placeholder||(e.maestroStyle?i.intl.formatMessage({id:"yUetMg",defaultMessage:"Doe"}):i.intl.formatMessage({id:"rew2qC",defaultMessage:"Last name"})),maestroStyle:e.maestroStyle,variant:e.variant,type:n.AuthTextInputType.TEXT,persistLabel:e.persistLabel});return(0,l.lastNameGoesFirst)()?r.default.createElement("div",{className:"register-form__name-fields"},g,m):r.default.createElement("div",{className:"register-form__name-fields"},m,g)}})),define("metaserver/static/js/auth/register/types",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RegisterFormEvent=void 0,(function(e){e.GOOGLE_REGISTER_CLICK="GOOGLE_REGISTER_CLICK",e.GOOGLE_REGISTER_SUCCESS="GOOGLE_REGISTER_SUCCESS",e.REGISTER_CLICK="REGISTER_CLICK",e.REGISTER_IMMEDIATE_SUCCESS="REGISTER_IMMEDIATE_SUCCESS"})(t.RegisterFormEvent||(t.RegisterFormEvent={}))})),define("metaserver/static/js/auth/register/view",["require","exports","tslib","classnames","react","metaserver/static/js/core/i18n","metaserver/static/js/auth/common/inputs/checkbox","metaserver/static/js/auth/common/inputs/text","metaserver/static/js/auth/common/captcha","metaserver/static/js/auth/common/types","metaserver/static/js/auth/register/google_register_button","metaserver/static/js/auth/register/name_fields","metaserver/static/js/auth/common/stats","metaserver/static/js/abuse/fingerprintjs_component","metaserver/static/js/google_one_tap/lib","metaserver/static/js/google_one_tap/containers"],(function(e,t,s,a,r,i,o,n,l,c,p,u,d,m,g,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RegisterFormView=void 0,a=s.__importDefault(a),r=s.__importDefault(r);class _ extends r.default.Component{constructor(){super(...arguments),this.state={splitSignupStep:0,formCollapsed:!1},this.handleContainerTransitionEnd=()=>{this.setState({formCollapsed:!0})},this.setCaptchaComponent=e=>{this.captchaComponent=e},this.setFingerprintJsComponent=e=>{this.fingerprintJsComponent=e}}componentDidUpdate(){var e;this.state.formCollapsed&&!(null===(e=this.props.gsiState)||void 0===e?void 0:e.formDisabled)&&this.setState({formCollapsed:!1})}handleCaptchaErrors(e){return(0,l.handle_captcha_errors)(this.captchaComponent,e)}getCaptchaComponent(){return this.captchaComponent}getFingerprintJsComponent(){return this.fingerprintJsComponent}getCaptchaResponses(){return(0,l.get_captcha_responses)(this.captchaComponent)}onContinue(){this.setState({splitSignupStep:1}),d.EmailAuthUXAnalyticsLogger.logSplitSignupContinue()}render(){var e,t,s,d;const{className:_,variant:f,thirdPartyInitiatedSignup:E,tosCheckboxProps:S,onGoogleRegisterClick:v,disabled:T,isSubmitting:b,maestroStyle:I,onInputChange:C,showMarketingOptIn:O,marketingOptInChecked:y,splitSignupEnabled:L,googleOneTapVariant:N=""}=this.props,A=(null===(e=this.props.gsiState)||void 0===e?void 0:e.formDisabled)&&((null===(t=this.props.gsiState)||void 0===t?void 0:t.isInline)||(null===(s=this.props.gsiState)||void 0===s?void 0:s.isButtonFlow)),R=(0,a.default)("form_shown","login-form-container","register",_,f,{third_party_auth:E,"login-form-container--maestro":I,[g.GOOGLE_ONE_TAP_COLLAPSE_FORM]:A}),w=S||{};let M=void 0;w.unsafeLabelHTML||(M=i.intl.formatMessage({id:"QECDJM",defaultMessage:"I agree to the <a>Dropbox Terms</a>. Learn about how we use and protect your data in our <b>Privacy Policy</b>."},{a:e=>r.default.createElement("a",{href:"/terms",target:"_blank",rel:"noreferrer noopener","data-uxa-log":"registration_dropbox_terms_link"},e),b:e=>r.default.createElement("a",{href:"/privacy",target:"_blank",rel:"noreferrer noopener","data-uxa-log":"registration_privacy_policy_link"},e)}));const P=this.props.submitButtonProps||{},F=(0,a.default)("login-button","button-primary",P.className,{"button-small":P.variant===c.AuthButtonVariant.SMALL,"button-big":P.variant===c.AuthButtonVariant.BIG}),G=(0,a.default)("continue-button","button-primary",P.className,{"button-small":P.variant===c.AuthButtonVariant.SMALL,"button-big":P.variant===c.AuthButtonVariant.BIG}),k=this.props.thirdPartyInitiatedSignup,D=["V1","V2"].includes(N),x=!!this.props.googleRegisterProps&&!k&&!D,U=this.props.googleRegisterProps||{},j=r.default.createElement(p.GoogleRegisterButton,{onClick:v,disabled:T||b,buttonProps:U.buttonProps}),H=r.default.createElement("div",{className:"hr-label"},r.default.createElement("span",{className:"hr-label__text"},i.intl.formatMessage({id:"F1g1bb",defaultMessage:"or"}))),B=this.props.emailProps||{},q=(0,a.default)("input-email","text-input__margin-right",B.className),V=this.props.passwordProps||{},W=(0,a.default)("input-password",V.className);let K=this.props.maestroStyle;"TOP"===U.position?K=!0:"BOTTOM"===U.position&&(K=!1);const X=w.variant||f,J=void 0===w.inline||w.inline,z=k?i.intl.formatMessage({id:"j7O6M6",defaultMessage:"Create and continue"}):P.text||i.intl.formatMessage({id:"P09UfX",defaultMessage:"Create an account"}),Y=this.props.tosChecked?"registration_agree_to_tos_uncheck":"registration_agree_to_tos_check",Q=i.intl.formatMessage({id:"pV/Btf",defaultMessage:"Continue"}),$=r.default.createElement(n.AuthTextField,{value:this.props.emailValue,className:q,onChange:C,disabled:T||B.readonly||!1,label:B.label||(I?i.intl.formatMessage({id:"ZuKPpH",defaultMessage:"Email"}):void 0),placeholder:B.placeholder||(this.props.maestroStyle?i.intl.formatMessage({id:"87vAZJ",defaultMessage:"you@mail.com"}):i.intl.formatMessage({id:"ZbTBdC",defaultMessage:"Email"})),error:this.props.emailError,maestroStyle:I,name:"email",type:c.AuthTextInputType.EMAIL,variant:f,persistLabel:this.props.persistLabel});if(L&&0===this.state.splitSignupStep)return r.default.createElement("div",{className:R},r.default.createElement("form",{className:"clearfix credentials-form register-form",onSubmit:this.props.onClickSignUp,method:"post"},r.default.createElement("div",{className:"credentials-form__fields"},r.default.createElement("div",{className:"register-form__credential-fields"}),r.default.createElement("div",{className:"split-signup-fields"},$,r.default.createElement("button",{className:G,type:"submit","data-uxa-log":"register_form_continue_button",onClick:()=>this.onContinue()},r.default.createElement("span",null,Q)))),x&&r.default.createElement("div",{className:"hr-split-signup"}),x&&j,x&&r.default.createElement(l.Captcha,{ref:this.setCaptchaComponent,email:this.props.emailValue,onSubmit:this.props.onSubmit,onReady:this.props.onCaptchaReady,source:"REGISTER"})));const Z=null===(d=this.props.gsiState)||void 0===d?void 0:d.tosPromptDisplayed,ee=!!this.props.gsiState&&this.props.gsiState.isInline,te=A&&this.state.formCollapsed?{display:"none"}:void 0;return r.default.createElement(r.default.Fragment,null,Z&&h.DEFAULT_TOS_INLINE_CONTAINER_REGISTER,r.default.createElement("div",{className:R,onTransitionEnd:A?this.handleContainerTransitionEnd:void 0,style:te},r.default.createElement("form",{className:"clearfix credentials-form register-form",onSubmit:this.props.onClickSignUp,method:"post",noValidate:!0},K&&x&&j,K&&x&&H,r.default.createElement("div",{className:"credentials-form__fields"},r.default.createElement(u.RegisterFormNameFields,{maestroStyle:I,onInputChange:C,combinedName:this.props.combinedName,fnameError:this.props.fnameError,fnameProps:this.props.fnameProps,lnameError:this.props.lnameError,lnameProps:this.props.lnameProps,fnameValue:this.props.fnameValue,lnameValue:this.props.lnameValue,disabled:T,variant:f,persistLabel:this.props.persistLabel}),r.default.createElement("div",{className:"register-form__credential-fields"},$,!this.props.thirdPartyInitiatedSignup&&r.default.createElement(n.AuthTextField,{value:this.props.passwordValue,placeholder:V.placeholder||(this.props.maestroStyle?i.intl.formatMessage({id:"klwYHA",defaultMessage:"Minimum 6 characters"}):i.intl.formatMessage({id:"i+PJQ7",defaultMessage:"Password"})),name:"password",className:W,inputClassName:"password-input",onChange:C,measureStrength:V.measureStrength,label:V.label||(I?i.intl.formatMessage({id:"i+PJQ7",defaultMessage:"Password"}):void 0),error:this.props.passwordError,maestroStyle:I,disabled:T,variant:f,passwordStrengthProps:V.strengthMeterProps,type:c.AuthTextInputType.PASSWORD,persistLabel:this.props.persistLabel}))),r.default.createElement(o.AuthCheckbox,{variant:X,className:"agree",disabled:w.disabled||T,maestroStyle:I,error:this.props.tosError,inline:J,onChange:C,name:"tos_agree",checked:this.props.tosChecked,label:w.label||M,unsafeLabelHTML:w.unsafeLabelHTML,uxaEventName:Y}),O&&r.default.createElement(o.AuthCheckbox,{variant:X,className:"agree marketing-opt-in-checkbox",disabled:T,maestroStyle:I,inline:J,onChange:C,checked:y,name:"marketing_opt_in",label:i.intl.formatMessage({id:"vRE9NS",defaultMessage:"Iâ€™d like to receive direct marketing email updates from Dropbox"})}),r.default.createElement("button",{className:F,type:"submit","data-uxa-log":"register_form_submit_button",disabled:this.props.disabled||P.disabled||this.props.isSubmitting},r.default.createElement("span",null,z)),D&&r.default.createElement(h.DefaultButtonContainerFC,{context:"signup",gsiState:this.props.gsiState}),!K&&x&&j,ee&&r.default.createElement(h.DefaultContainerFC,{context:"signup",gsiState:this.props.gsiState}),r.default.createElement(l.Captcha,{ref:this.setCaptchaComponent,email:this.props.emailValue,onSubmit:this.props.onSubmit,onReady:this.props.onCaptchaReady,source:"REGISTER"}),r.default.createElement(m.FingerprintJs,{ref:this.setFingerprintJsComponent,source:"REGISTER"}))))}}t.RegisterFormView=_,_.displayName="RegisterFormView"})),define("metaserver/static/js/components/password_strength_meter",["require","exports","tslib","react","classnames","metaserver/static/js/core/i18n","metaserver/static/js/components/ui/css","metaserver/static/js/clean/ui/bubble_dropdown_v2","metaserver/static/js/clean/web_timing_logger","metaserver/static/js/core/cancelable_promise","metaserver/static/js/clean/ui/sticky_position","dig-components/tooltips"],(function(e,t,s,a,r,i,o,n,l,c,p,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PasswordStrengthMeter=void 0,a=s.__importDefault(a),r=s.__importDefault(r);class d extends a.default.Component{constructor(t){super(t),this.setZxcvbn=({default:e})=>{this.setState({zxcvbn:e})},this.getPasswordScore=e=>this.state.zxcvbn?this.state.zxcvbn(e).score:0,this.renderPasswordDots=(e,t)=>{const{isDigEnabled:s,bubblePosition:r,bubbleClassName:o,bubbleDescription:l}=this.props,c=i.intl.formatMessage({id:"6SDr7W",defaultMessage:"Passwords must be 6 characters or more. Good passwords are hard to guess and use uncommon words, numbers, symbols, and uppercase letters."}),u=l||c,d="password_strength_meter_tooltip";return s?a.default.createElement(g,{score:e,title:t,description:u,className:o}):a.default.createElement(a.default.Fragment,null,a.default.createElement(m,{score:e}),a.default.createElement(n.BubbleDropdown,{position:r||p.StickyPosition.RIGHT,isContentFocusable:!1,targetButton:a.default.createElement("button",{type:"button","aria-label":i.intl.formatMessage({id:"bjXtDK",defaultMessage:"Show more information about password strength."}),"aria-describedby":d,"aria-controls":d,className:"password-bubble__button"}),className:o},a.default.createElement("div",{id:d,role:"tooltip",className:"password-bubble__content"},a.default.createElement("div",{className:"password-bubble__title"},t||""),a.default.createElement("div",{className:"password-bubble__desc"},u))))},this.state={},t.zxcvbnPostTti?(0,l.waitForTTI)().then(()=>{this.zxcvbnPromise=(0,c.makeCancelable)(new Promise((t,s)=>{e(["zxcvbn"],t,s)}).then(s.__importStar)),this.zxcvbnPromise.then(this.setZxcvbn)}):(this.zxcvbnPromise=(0,c.makeCancelable)(new Promise((t,s)=>{e(["zxcvbn"],t,s)}).then(s.__importStar)),this.zxcvbnPromise.then(this.setZxcvbn))}componentWillUnmount(){this.zxcvbnPromise&&this.zxcvbnPromise.cancel()}getTitle(e){return["",i.intl.formatMessage({id:"i/ragh",defaultMessage:"Weak"}),i.intl.formatMessage({id:"GwYES8",defaultMessage:"So-so"}),i.intl.formatMessage({id:"Yd7c8F",defaultMessage:"Good"}),i.intl.formatMessage({id:"kbsmZh",defaultMessage:"Great!"})][e]}render(){const{password:e,className:t}=this.props,s=e.length?Math.max(1,this.getPasswordScore(e)):0,o=this.getTitle(s);return a.default.createElement("div",{className:(0,r.default)("password-input-meter",{[`${t}`]:t}),"aria-label":i.intl.formatMessage({id:"7h/xn+",defaultMessage:"Password strength"})},a.default.createElement("span",{"aria-live":"assertive",className:"ax-visually-hidden"},o),this.renderPasswordDots(s,o))}}d.displayName="PasswordStrengthMeterComponent";const m=({score:e})=>a.default.createElement(a.default.Fragment,null,[4,3,2,1].map(t=>{const s=(0,r.default)({"password-input-dot":!0,"password-input-dot-selected--weak":e>=t&&e<=2,"password-input-dot-selected":e>=t});return a.default.createElement("div",{key:"password-input-dot-"+t,className:s})})),g=({score:e,description:t,title:s,className:r})=>{const i=s?`(${s}) ${t}`:`${t}`;return a.default.createElement(u.Tooltip,{title:i,placement:"right",className:r},a.default.createElement("span",{tabIndex:0},a.default.createElement(m,{score:e})))};t.PasswordStrengthMeter=(0,o.requireCssWithComponent)(d,["/static/metaserver/static/css/components/password_strength_meter-vfldJoBwE.css"])})),define("metaserver/static/js/form_util/name_parser",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=class{static splitFullName(e){const t=e.split(" ");return[t[0],t.slice(1).join(" ")]}}})),define("metaserver/static/js/abuse/fingerprintjs_component",["require","exports","tslib","react","react-dom","metaserver/static/js/core/uri","metaserver/static/js/modules/constants/fingerprintjs_constants","metaserver/static/js/modules/constants/env","metaserver/static/js/logging/telemetry","metaserver/static/js/logging/hive/schemas/abuse-fingerprintjs_logs","metaserver/static/js/components/ui/css","metaserver/static/js/core/exception","metaserver/static/js/metrics/index","metaserver/static/js/modules/constants/login_and_register"],(function(e,t,s,a,r,i,o,n,l,c,p,u,d,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FingerprintJs=t.FingerprintJsComponent=t.isTest=void 0,a=s.__importDefault(a),r=s.__importStar(r),l=s.__importStar(l),u=s.__importStar(u);t.isTest=()=>m.IS_SELENIUM_TEST;class g extends a.default.Component{constructor(e){super(e),this.postFPJSTokenAndLog=e=>s.__awaiter(this,void 0,void 0,(function*(){var t,s;o.SHOULD_INVOKE_FINGERPRINTJS&&(null==this.state.fpResponse?(this.getIFrame().contentWindow.postMessage({token:o.FINGERPRINTJS_TOKEN},"*"),yield(t=e=>null!=this.state.fpResponse,s=7e3,new Promise(e=>{t()?e():setTimeout(t=>e(),s)})).then(()=>{null==this.state.fpResponse?this.recordFingerprintJsLoadingStats(this.props.source,!1,this.state.err):(this.logFPResponse(e),this.recordFingerprintJsLoadingStats(this.props.source,!0,this.state.err))})):this.logFPResponse(e))})),this.recordFingerprintJsLoadingStats=(e,t,s)=>{const a=(0,d.getMetricsReporter)().createCounter({ns:"abuse",name:"fingerprintjs/loading_result"},{is_success:String(t),event:e,err:s});a.increment(),a.record()},this.logFPResponse=e=>{const t=this.state.fpResponse;try{this.fingerprintJsInfoLogger.log(new c.FingerprintJsLogsRow({email:e,event:this.props.source,request_id:t.requestId,visitor_id:t.visitorId,visitor_found:t.visitorFound,confidence_score:void 0,confidence_comment:t.confidence?t.confidence.comment:"",browser_name:t.browserName,browser_version:t.browserVersion,device:t.device,incognito:t.incognito,ip:t.ip,latitude:t.ipLocation?t.ipLocation.latitude:"",longitude:t.ipLocation?t.ipLocation.longitude:"",timezone:t.ipLocation?t.ipLocation.timezone:"",city:t.ipLocation&&t.ipLocation.city?t.ipLocation.city.name:"",country:t.ipLocation&&t.ipLocation.country?t.ipLocation.country.name:"",os:t.os,os_version:t.osVersion,confidence_score_double:t.confidence.score}))}catch(e){u.reportException({err:e,severity:u.SEVERITY.CRITICAL,tags:["fingerprintjs"]})}},this.fingerprintJsInfoLogger=new l.HiveLogger,this.state={fpResponse:void 0,err:"None"}}getIFrame(){return r.findDOMNode(this.refs.iframe)}componentDidMount(){window.addEventListener("message",e=>{e.data&&i.URI.parse(e.origin).getAuthority()===n.FINGERPRINTJS_SERVER&&(e.data.result&&this.setState({fpResponse:e.data.result}),e.data.err&&this.setState({err:e.data.err}))})}render(){const e=new i.URI({scheme:"https",authority:n.FINGERPRINTJS_SERVER}).toString(),t=a.default.createElement("iframe",{id:"fingerprintjs_iframe",sandbox:"allow-scripts allow-same-origin allow-forms",className:"fingerprintjs-frame",src:e,ref:"iframe",key:"iframe-id",hidden:!0});return a.default.createElement("div",{className:"fingerprintjsDiv"},t)}}t.FingerprintJsComponent=g,g.displayName="FingerprintJsComponent",t.FingerprintJs=(0,p.requireCssWithComponent)(g,["/static/metaserver/static/css/abuse/fingerprintjs_component-vfleQmAgD.css"])})),define("metaserver/static/js/logging/hive/schemas/abuse-fingerprintjs_logs",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FingerprintJsLogsRow=void 0;t.FingerprintJsLogsRow=class{constructor(e){this.category="abuse-fingerprintjs_logs",this.email=e.email,this.event=e.event,this.request_id=e.request_id,this.visitor_id=e.visitor_id,this.visitor_found=e.visitor_found,this.confidence_score=void 0,this.confidence_comment=e.confidence_comment,this.browser_name=e.browser_name,this.browser_version=e.browser_version,this.device=e.device,this.incognito=e.incognito,this.ip=e.ip,this.latitude=e.latitude,this.longitude=e.longitude,this.timezone=e.timezone,this.city=e.city,this.country=e.country,this.os=e.os,this.os_version=e.os_version,this.confidence_score_double=e.confidence_score_double,Object.seal(this)}}})),define("metaserver/static/js/clean/sso_login_checks",["require","exports","tslib","metaserver/static/js/deprecated_ajax/ajax_jquery"],(function(e,t,s,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SsoLoginChecks=void 0,a=s.__importStar(a);class r{constructor(e,t,s,a=!0){this._trigger_check_sso_state=this._trigger_check_sso_state.bind(this),this.check_sso_state=this.check_sso_state.bind(this),this.$email_input=e,this.show_sso_fn=t,this.hide_sso_fn=s,this.should_trigger_check=a,this.should_trigger_check&&(this._trigger_check_sso_state(),this.$email_input.on("input keyup change",this._trigger_check_sso_state))}static initClass(){this._sso_check_in_flight={},this._sso_check_cache={}}_trigger_check_sso_state(){const e=this.$email_input.val();return this.check_sso_state(e)}check_sso_state(e){const t=e.trim();if(!t.match(/^[^@\s]+@[^@\s]+\.[A-Za-z]{2,}$/))return this.hide_sso_fn();{const s=t.toLowerCase();if(s in r._sso_check_cache)return this._handle_sso_state(r._sso_check_cache[s]);if(!r._sso_check_in_flight[s])return r._sso_check_in_flight[s]=!0,a.WebRequest({url:"/sso_state",data:{email:t},success:t=>(t=JSON.parse(t),delete r._sso_check_in_flight[s],r._sso_check_cache[s]=t.user_sso_state,this.should_trigger_check&&this.$email_input.val()!==e?this._trigger_check_sso_state():this._handle_sso_state(t.user_sso_state)),error:()=>(delete r._sso_check_in_flight[s],this.hide_sso_fn())})}}_handle_sso_state(e){return"required"===e?this.show_sso_fn(!1):"optional"===e?this.show_sso_fn(!0):this.hide_sso_fn()}}t.SsoLoginChecks=r,r.initClass()})),define("metaserver/static/js/clean/web_register_logging_data",["require","exports","tslib","metaserver/static/js/core/browser","metaserver/static/js/modules/core/transport/query_string_helpers"],(function(e,t,s,a,r){"use strict";function i(){return{signupUrl:a.get_href(),signupReferrer:document.referrer,trackingParams:(0,r.getTrackingParamsAsJSON)()}}Object.defineProperty(t,"__esModule",{value:!0}),t.setWebRegisterLoggingData=t.getWebRegisterLoggingData=void 0,a=s.__importStar(a),t.getWebRegisterLoggingData=i,t.setWebRegisterLoggingData=function(e={}){const{signupUrl:t,signupReferrer:s,trackingParams:a}=i(),r={signup_url:t,signup_referrer:s,tracking_params:a};return Object.assign(Object.assign({},e),r)}})),define("metaserver/static/js/google_one_tap/google_one_tap_platform",["require","exports","tslib","metaserver/static/js/google_one_tap/lib","metaserver/static/js/core/browser","metaserver/static/js/core/notify","metaserver/static/js/core/i18n","metaserver/static/js/auth/common/stats","metaserver/static/js/google_one_tap/one_tap_tos","metaserver/static/js/fedramp/fedramp_util","metaserver/static/js/core/uri","metaserver/static/js/google_one_tap/google_one_tap_helpers","metaserver/static/js/auth/login/types","metaserver/static/js/auth/login/sso_utils"],(function(e,t,s,a,r,i,o,n,l,c,p,u,d,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.initialize_module=t.GoogleOneTapPlatform=t.GoogleOneTapPlatformSingleton=void 0,r=s.__importStar(r);class g{constructor(){if(this.tosPromptShown=!1,this.googleIframeObserver=null,this.bodyClass="google-one-tap-displayed",this.tosBodyClass="google-one-tap-tos-displayed",this.currentContext="signin",this.isPromptClosed=!1,this.init=e=>{!this.config&&e&&(this.config=e,this.currentContext=e.context,a.GSIEventManager.sendGSIEvent(a.GSIEvent.INITIALIZE_PLATFORM),e.context!==a.GSIEventManager.getGSIState().context&&this.updateStateContext(e.context),e.isInline&&(a.GSIEventManager.sendGSIEvent(a.GSIEvent.USE_INLINE_PROMPT),a.GSIEventManager.sendGSIEvent(a.GSIEvent.PROMPT_OPEN),document.body.addEventListener("focusin",this.handleFocusIn)),this.loadGSILibrary().then(this.initGSIClient),this.listenForContextChanges())},this.loadGSILibrary=()=>{const e=document.getElementsByTagName("head")[0],t=document.createElement("script");return t.type="text/javascript",t.async=!0,t.defer=!0,t.src="https://accounts.google.com/gsi/client",e.insertBefore(t,e.firstChild),new Promise(e=>{window.onGoogleLibraryLoad=e})},this.initGSIClient=()=>{this.config.clientId&&"undefined"!=typeof google&&(this.applyPendingContext(),a.GSIEventManager.clearPendingContext(),this.initContainerListeners())},this.displaySigButton=()=>{this.initGoogleAccount();let e,t=null;"signin"===this.currentContext?(t=document.getElementById(a.DEFAULT_SIGNIN_BUTTON_CONTAINER_ID),e=a.SIG_BUTTON_TEXT.CONTINUE_WITH):"signup"===this.currentContext&&(t=document.getElementById(a.DEFAULT_SIGNUP_BUTTON_CONTAINER_ID),e=a.SIG_BUTTON_TEXT.SIGN_UP_WITH),t&&google.accounts.id.renderButton(t,{text:e,width:350,logo_alignment:"left",locale:this.config.locale})},this.initContainerListeners=()=>{this.config.isInline&&!a.GSIEventManager.getGSIState().inlineContainerMounted||this.displayOneTapPrompt(),a.GSIEventManager.createGSIEventListener(a.GSIEvent.INLINE_CONTAINER_MOUNTED,this.displayOneTapPrompt),a.GSIEventManager.getGSIState().buttonContainerMounted&&this.displaySigButton(),a.GSIEventManager.createGSIEventListener(a.GSIEvent.BUTTON_CONTAINER_MOUNTED,this.displaySigButton)},this.displayOneTapPrompt=()=>{const e=!!document.getElementById(this.getPromptParentId()||"");this.config.isInline&&!e||(this.initGoogleAccount(),google.accounts.id.prompt(e=>{e.isDisplayMoment()&&this.handleDisplayMoment(e);const t=e.isNotDisplayed()||e.isSkippedMoment()||e.isDismissedMoment();let s="";e.isDismissedMoment&&((0,u.oneTapClickEvent)(a.GoogleOneTapEvent.DISMISS_GOOGLE_ONE_TAP),s=e.getDismissedReason()),this.setPromptClosedState(t,s),t?((0,u.oneTapDisplayEvent)(a.GoogleOneTapEvent.GOOGLE_ONE_TAP_NOT_SHOWN,!1),this.setOneTapHeightCssVar("0px"),this.stopObservingGoogleContainer(),document.body.classList.remove(this.bodyClass)):(0,u.oneTapDisplayEvent)(a.GoogleOneTapEvent.SHOW_GOOGLE_ONE_TAP,!0),(e.isSkippedMoment()||e.isDismissedMoment)&&(0,u.oneTapDisplayEvent)(a.GoogleOneTapEvent.LOGGED_IN_GOOGLE_USER,!1)}))},this.handleDisplayMoment=e=>{a.GSIEventManager.sendGSIEvent(a.GSIEvent.DISPLAY_MOMENT),e.isDisplayed()&&(this.setOneTapHeightCssVar(this.getOneTapIframeHeight()),this.observeGoogleIframe(),document.body.classList.add(this.bodyClass),this.config.isInline&&this.pollAndClearIframeFocus())},this.setPromptClosedState=(e,t)=>{this.isPromptClosed=e,e?a.GSIEventManager.sendGSIEvent(a.GSIEvent.PROMPT_CLOSE,{dismissReason:t}):a.GSIEventManager.sendGSIEvent(a.GSIEvent.PROMPT_OPEN)},this.listenForContextChanges=()=>{this.clearContextChangesListener(),a.GSIEventManager.createGSIEventListener(a.GSIEvent.CONTEXT_CHANGE_SIGNUP,this.handleContextChange),a.GSIEventManager.createGSIEventListener(a.GSIEvent.CONTEXT_CHANGE_SIGNIN,this.handleContextChange)},this.clearContextChangesListener=()=>{a.GSIEventManager.removeGSIEventListener(a.GSIEvent.CONTEXT_CHANGE_SIGNUP,this.handleContextChange),a.GSIEventManager.removeGSIEventListener(a.GSIEvent.CONTEXT_CHANGE_SIGNIN,this.handleContextChange)},this.applyPendingContext=()=>{a.GSIEventManager.getPendingContext()&&this.setCurrentContext(a.GSIEventManager.getPendingContext())},this.handleContextChange=()=>{const e=a.GSIEventManager.getGSIState().context;e!==this.currentContext&&(this.cancelTOS(),this.setCurrentContext(e),this.refreshGSIClient())},this.refreshGSIClient=()=>{var e;a.GSIEventManager.getGSIState().gsiClientInitialized&&(a.GSIEventManager.sendGSIEvent(a.GSIEvent.RESET_DISPLAY_MOMENT),(null===(e=this.config)||void 0===e?void 0:e.isInline)&&"undefined"!=typeof google&&google.accounts.id.cancel(),this.initGSIClient())},this.googleSignInCallback=({select_by:e,credential:t})=>{const s=a.BUTTON_AUTH_TYPES.includes(e);s?(0,u.oneTapClickEvent)(a.GoogleOneTapEvent.GOOGLE_ONE_TAP_SIG_BUTTON_CLICKED):(0,u.oneTapClickEvent)(a.GoogleOneTapEvent.GOOGLE_ONE_TAP_CONTINUE),a.GSIEventManager.sendGSIEvent(s?a.GSIEvent.USE_BUTTON_FLOW:a.GSIEvent.USE_ONE_TAP_FLOW),this.googleCredentials=t,this.selectBy=e,this.signIn(s)},this.signIn=e=>{(0,u.getIdentityClient)(this.googleCredentials,this.selectBy,!1).then(t=>{const s=(0,c.getFedrampRedirectUrlIfApplicable)(t.is_fedramp_user||!1,t.redirect_url||a.DEFAULT_CONTINUATION_URL),l=t[".tag"];switch("tos_required"!=l&&n.AuthAMPLogger.logLoginAttempt(n.AuthType.GOOGLE_ONE_TAP,"normal"),l){case"success":e?n.AuthAMPLogger.logThirdPartyLoginResponse(n.AuthType.GOOGLE,"normal",!0,null):n.AuthAMPLogger.logThirdPartyLoginResponse(n.AuthType.GOOGLE_ONE_TAP,"normal",!0,null),i.Notify.success(o.intl.formatMessage({id:"Ce9FpX",defaultMessage:"Log in successful! Your browser will be redirected in a few seconds."})),r.redirect(s);break;case"requires_twofactor":{n.AuthAMPLogger.logThirdPartyLoginResponse(n.AuthType.GOOGLE_ONE_TAP,"normal",!1,"tfa_required");const e=new p.URI({path:"/verify_code"}).updateQuery({remember_me:t.remember_me.toString(),pair_user:t.pair_user.toString(),cont:s});r.redirect(e.toString());break}case"tos_required":n.AuthAMPLogger.logThirdPartyLoginResponse(n.AuthType.GOOGLE_ONE_TAP,"normal",!1,l),a.GSIEventManager.sendGSIEvent(a.GSIEvent.TOS_PROMPT_OPEN),this.showTOSPrompt(e);break;case"enable_twofactor_required":{n.AuthAMPLogger.logThirdPartyLoginResponse(n.AuthType.GOOGLE_ONE_TAP,"normal",!1,l);const e=new p.URI({path:"/twofactor"}).updateQuery({remember_me:t.remember_me.toString(),pair_user:t.pair_user.toString(),cont:s});r.redirect(e.toString());break}case"google_login_not_allowed":n.AuthAMPLogger.logThirdPartyLoginResponse(n.AuthType.GOOGLE_ONE_TAP,"normal",!1,l),i.Notify.error(o.intl.formatMessage({id:"u1xMG/",defaultMessage:"Google Sign In is not allowed with this email."})),this.ssoChecker.checkSsoState(t.profile.email,this.onSsoStateUpdate);break;case"sso_required":n.AuthAMPLogger.logThirdPartyLoginResponse(n.AuthType.GOOGLE_ONE_TAP,"normal",!1,l),window.location.href.includes("/register")?i.Notify.error(o.intl.formatMessage({id:"RAxZa6",defaultMessage:"This email address is already taken. Please sign in."})):window.location.href.includes("/login")&&a.GSIEventManager.sendGSIEvent(a.GSIEvent.SSO_REQUIRED,{email:t.profile.email});break;case"requires_password":{n.AuthAMPLogger.logThirdPartyLoginResponse(n.AuthType.GOOGLE_ONE_TAP,"normal",!1,null);const e=new p.URI({path:"/show_password_form"}).updateQuery({remember_me:t.remember_me.toString(),pair_user:t.pair_user.toString(),cont:s});r.redirect(e.toString());break}default:n.AuthAMPLogger.logThirdPartyLoginResponse(n.AuthType.GOOGLE_ONE_TAP,"normal",!1,null),i.Notify.error(o.intl.formatMessage({id:"xG7rbH",defaultMessage:"There was a problem completing this request. Please Try Again."}))}}).catch(e=>{n.AuthAMPLogger.logThirdPartyLoginResponse(n.AuthType.GOOGLE_ONE_TAP,"normal",!1,e[".tag"]),(0,u.handleClientError)(e)})},this.onSsoStateUpdate=(e,t)=>{t!=d.SsoState.REQUIRED&&t!=d.SsoState.OPTIONAL||a.GSIEventManager.sendGSIEvent(a.GSIEvent.SSO_REQUIRED,{email:e})},this.signUp=e=>(0,u.getIdentityClient)(this.googleCredentials,this.selectBy,!0,e).then(e=>{switch(e[".tag"]){case"success":{n.AuthAMPLogger.logSignupResponse(n.AuthType.GOOGLE_ONE_TAP,!0,null);const t=(0,c.getFedrampRedirectUrlIfApplicable)(e.is_fedramp_user||!1,e.redirect_url||"/trial_first");return r.redirect(t),!0}default:return i.Notify.error(o.intl.formatMessage({id:"xG7rbH",defaultMessage:"There was a problem completing this request. Please Try Again."})),!1}}).catch(e=>(n.AuthAMPLogger.logSignupResponse(n.AuthType.GOOGLE_ONE_TAP,!1,e[".tag"]),(0,u.handleClientError)(e),!1)),this.showTOSPrompt=e=>{if(!this.tosPromptShown){const t=this.config.isInline||e?l.TOSModalVariant.V2:l.TOSModalVariant.V1;let s;t==l.TOSModalVariant.V2&&"signin"===this.currentContext&&(s=l.TOSModalVariant.V1),(0,l.displayTOS)({modalVariant:t,animationVariant:s,onToggle:this.handleToggleTOS,onDismiss:this.handleDismissTOS,onSubmit:this.handleTOSSubmit,containerParentSelector:t===l.TOSModalVariant.V2?`${"signup"===this.currentContext?a.DEFAULT_ONE_TAP_INLINE_TOS_ID_REGISTER:a.DEFAULT_ONE_TAP_INLINE_TOS_ID_LOGIN}`:void 0,showMarketingOptIn:this.config.showMarketingOptIn}),this.tosPromptShown=!0,document.body.classList.add(this.tosBodyClass)}},this.cancelTOS=()=>{a.GSIEventManager.sendGSIEvent(a.GSIEvent.TOS_PROMPT_CLOSE),this.tosPromptShown&&((0,l.unmountTOS)(),this.tosPromptShown=!1)},this.handleDismissTOS=()=>{(0,u.oneTapClickEvent)(a.GoogleOneTapEvent.GOOGLE_ONE_TAP_SIGNUP_DISMISS_TOS),this.cancelTOS(),document.body.classList.remove(this.tosBodyClass),this.refreshGSIClient()},this.handleToggleTOS=e=>{},this.handleTOSSubmit=e=>((0,u.oneTapClickEvent)(a.GoogleOneTapEvent.GOOGLE_ONE_TAP_SIGNUP_CLICK),n.AuthAMPLogger.logSignupAttempt(n.AuthType.GOOGLE_ONE_TAP),this.signUp(e)),this.observeGoogleIframe=()=>{const e=this.getGoogleIframe();!this.googleIframeObserver&&e&&(this.googleIframeObserver=new MutationObserver(this.googleIframeObserverCallback),this.googleIframeObserver.observe(e,{attributes:!0}))},this.stopObservingGoogleContainer=()=>{var e;null===(e=this.googleIframeObserver)||void 0===e||e.disconnect(),this.googleIframeObserver=null},this.googleIframeObserverCallback=e=>{e.length&&"style"===e[0].attributeName&&this.setOneTapHeightCssVar(this.getOneTapIframeHeight())},this.setOneTapHeightCssVar=e=>{this.styleTag||(this.styleTag=document.createElement("style"),document.head.appendChild(this.styleTag)),this.styleTag.innerText=`:root { ${a.ONE_TAP_HEIGHT_CSS_VAR}: ${e}; }`},this.getGoogleIframe=()=>document.getElementById(a.GOOGLE_ONE_TAP_IFRAME_ID)||document.querySelector(`#${a.GOOGLE_ONE_TAP_CREDENTIAL_CONTAINER_ID} iframe`),this.getOneTapIframeHeight=()=>{const e=this.getGoogleIframe();return(null==e?void 0:e.style.height)||"0px"},this.pollAndClearIframeFocus=()=>{const e=setInterval(()=>{document.activeElement&&document.activeElement===this.getGoogleIframe()&&(document.activeElement.blur(),this.activeElement.focus(),clearInterval(e))},10);setTimeout(()=>clearInterval(e),5e3)},this.handleFocusIn=()=>{document.activeElement!==this.getGoogleIframe()&&(this.activeElement=document.activeElement)},this.getPromptParentId=()=>{var e;return(null===(e=this.config)||void 0===e?void 0:e.isInline)?this.getInlineContainerId():void 0},this.getInlineContainerId=()=>this.config&&"signup"===this.currentContext?a.DEFAULT_SIGNUP_CONTAINER_ID:a.DEFAULT_SIGNIN_CONTAINER_ID,this.setCurrentContext=e=>{this.currentContext=e},this.updateStateContext=e=>{const t="signup"===e?a.GSIEvent.CONTEXT_CHANGE_SIGNUP:a.GSIEvent.CONTEXT_CHANGE_SIGNIN;a.GSIEventManager.sendGSIEvent(t)},g.instance)return g.instance;g.instance=this,this.ssoChecker=new m.SsoStateChecker}initGoogleAccount(){const e={client_id:this.config.clientId,callback:this.googleSignInCallback,cancel_on_tap_outside:!1,context:this.currentContext,prompt_parent_id:this.getPromptParentId(),itp_support:!0};google.accounts.id.initialize(e),a.GSIEventManager.getGSIState().gsiClientInitialized||a.GSIEventManager.sendGSIEvent(a.GSIEvent.INITIALIZE_GSI_CLIENT)}}t.GoogleOneTapPlatformSingleton=g,t.GoogleOneTapPlatform=new g,t.initialize_module=function(e){t.GoogleOneTapPlatform.init(e)}})),define("metaserver/static/js/google_one_tap/lib",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DEFAULT_CONTINUATION_URL=t.ONE_TAP_HEIGHT_CSS_VAR=t.GOOGLE_ONE_TAP_CREDENTIAL_CONTAINER_ID=t.GOOGLE_ONE_TAP_IFRAME_ID=t.GOOGLE_ONE_TAP_COLLAPSE_FORM=t.GOOGLE_ONE_TAP_DISABLED_FORM=t.DEFAULT_ONE_TAP_INLINE_TOS_ID_LOGIN=t.DEFAULT_ONE_TAP_INLINE_TOS_ID_REGISTER=t.DEFAULT_ONE_TAP_CONTAINER_CLASS=t.DEFAULT_SIGNIN_BUTTON_CONTAINER_ID=t.DEFAULT_SIGNUP_BUTTON_CONTAINER_ID=t.DEFAULT_SIGNIN_CONTAINER_ID=t.DEFAULT_SIGNUP_CONTAINER_ID=t.GSIEvent=t.GSIEventManager=t.BUTTON_AUTH_TYPES=t.DismissReason=t.SIG_BUTTON_TEXT=t.GoogleOneTapEvent=void 0,(function(e){e.DISMISS_GOOGLE_ONE_TAP="dismiss_google_onetap",e.GOOGLE_ONE_TAP_CONTINUE="google_onetap_continue",e.GOOGLE_ONE_TAP_NOT_SHOWN="google_onetap_not_shown",e.GOOGLE_ONE_TAP_ACCOUNT_CREATION_SUCCESS="google_onetap_account_creation_success",e.GOOGLE_ONE_TAP_ACCOUNT_LOGIN_SUCCESS="google_onetap_account_login_success",e.GOOGLE_ONE_TAP_SIGNUP_CLICK="google_onetap_signup_click",e.GOOGLE_ONE_TAP_SIGNUP_DISMISS_TOS="google_onetap_signup_dismiss_tos",e.GOOGLE_ONE_TAP_SIGNUP_PLEASE_AGREE_TO_TOS="google_onetap_signup_please_agree_to_tos",e.GOOGLE_ONE_TAP_VERIFICATION_FAILED="google_onetap_verification_failed",e.GOOGLE_ONE_TAP_VERIFICATION_SUCCESS="google_onetap_verification_success",e.GOOGLE_ONE_TAP_SIG_BUTTON_CLICKED="google_onetap_sig_button_clicked",e.LOGGED_IN_GOOGLE_USER="loggedin_google_user",e.SHOW_GOOGLE_ONE_TAP="show_google_onetap"})(t.GoogleOneTapEvent||(t.GoogleOneTapEvent={})),(function(e){e.CONTINUE_WITH="continue_with",e.SIGN_IN_WITH="signin_with",e.SIGN_UP_WITH="signup_with"})(t.SIG_BUTTON_TEXT||(t.SIG_BUTTON_TEXT={})),(function(e){e.inFlow="credential_returned"})(t.DismissReason||(t.DismissReason={})),t.BUTTON_AUTH_TYPES=["btn","btn_confirm","btn_add_session","btn_confirm_add_session"];const s={platformInitialized:!1,gsiClientInitialized:!1,displayMoment:!1,isInline:!1,isPromptClosed:!0,context:"signin",pendingContext:null,buttonContainerMounted:!1,inlineContainerMounted:!1,tosPromptDisplayed:!1,dismissReason:"",formDisabled:!1,isButtonFlow:!1,email:""};let a=s;const r=e=>`gsi_${e.toString()}`,i=e=>{a.pendingContext=e},o=e=>{const t=e.detail;a=Object.assign(Object.assign({},a),t||{}),e.type!==r(n.STATE_CHANGE)&&window.dispatchEvent(p(n.STATE_CHANGE))};var n;t.GSIEventManager={sendGSIEvent:(e,{email:t,dismissReason:s}={})=>{const r=c.includes(e),o=p(e,{email:t,dismissReason:s});o&&(window.dispatchEvent(o),r&&!a.platformInitialized&&i(o.detail.context))},getGSIState:()=>a,getPendingContext:()=>a.pendingContext,clearPendingContext:()=>{a.pendingContext=null},getEventType:r,createGSIEventListener:(e,t)=>{const s=e=>window.addEventListener(r(e),t);Array.isArray(e)?e.forEach(e=>{s(e)}):s(e)},removeGSIEventListener:(e,t)=>{const s=e=>window.removeEventListener(r(e),t);Array.isArray(e)?e.forEach(e=>{s(e)}):s(e)},resetGSIState:()=>{a=s}},(function(e){e.STATE_CHANGE="state_change",e.CONTEXT_CHANGE_SIGNUP="context_change_signup",e.CONTEXT_CHANGE_SIGNIN="context_change_signin",e.INITIALIZE_PLATFORM="initialize_platform",e.INITIALIZE_GSI_CLIENT="initialize_gsi_client",e.DISPLAY_MOMENT="display_moment",e.RESET_DISPLAY_MOMENT="reset_display_moment",e.USE_INLINE_PROMPT="use_inline_prompt",e.PROMPT_CLOSE="prompt_close",e.PROMPT_OPEN="prompt_open",e.INLINE_CONTAINER_MOUNTED="inline_container_mounted",e.BUTTON_CONTAINER_MOUNTED="button_container_mounted",e.TOS_PROMPT_OPEN="tos_prompt_open",e.TOS_PROMPT_CLOSE="tos_prompt_closed",e.USE_BUTTON_FLOW="use_button_flow",e.USE_ONE_TAP_FLOW="use_one_tap_flow",e.SSO_REQUIRED="sso_required"})(n=t.GSIEvent||(t.GSIEvent={}));const l={context_change_signup:"signup",context_change_signin:"signin"},c=[n.CONTEXT_CHANGE_SIGNIN,n.CONTEXT_CHANGE_SIGNUP],p=(e,{email:t,dismissReason:s}={})=>{const a=r(e);switch(e){case n.CONTEXT_CHANGE_SIGNUP:case n.CONTEXT_CHANGE_SIGNIN:return new CustomEvent(a,{detail:{context:l[e.toString()],formDisabled:!1}});case n.INITIALIZE_PLATFORM:return new CustomEvent(a,{detail:{platformInitialized:!0}});case n.INITIALIZE_GSI_CLIENT:return new CustomEvent(a,{detail:{gsiClientInitialized:!0}});case n.DISPLAY_MOMENT:return new CustomEvent(a,{detail:{displayMoment:!0}});case n.RESET_DISPLAY_MOMENT:return new CustomEvent(a,{detail:{displayMoment:!1}});case n.USE_INLINE_PROMPT:return new CustomEvent(a,{detail:{isInline:!0}});case n.PROMPT_CLOSE:return new CustomEvent(a,{detail:{isPromptClosed:!0,dismissReason:s}});case n.PROMPT_OPEN:return new CustomEvent(a,{detail:{isPromptClosed:!1}});case n.BUTTON_CONTAINER_MOUNTED:return new CustomEvent(a,{detail:{buttonContainerMounted:!0}});case n.INLINE_CONTAINER_MOUNTED:return new CustomEvent(a,{detail:{inlineContainerMounted:!0}});case n.TOS_PROMPT_OPEN:return new CustomEvent(a,{detail:{tosPromptDisplayed:!0,formDisabled:!0}});case n.TOS_PROMPT_CLOSE:return new CustomEvent(a,{detail:{tosPromptDisplayed:!1,formDisabled:!1,dismissReason:""}});case n.USE_BUTTON_FLOW:return new CustomEvent(a,{detail:{isButtonFlow:!0}});case n.USE_ONE_TAP_FLOW:return new CustomEvent(a,{detail:{isButtonFlow:!1}});case n.STATE_CHANGE:return new CustomEvent(a);case n.SSO_REQUIRED:return new CustomEvent(a,{detail:{email:t}});default:return console.log("invalid event"),null}};Object.values(n).forEach(e=>{const t=r(e);window.addEventListener(t,o)}),t.DEFAULT_SIGNUP_CONTAINER_ID="google-one-tap-inline-container-register",t.DEFAULT_SIGNIN_CONTAINER_ID="google-one-tap-inline-container-login",t.DEFAULT_SIGNUP_BUTTON_CONTAINER_ID="sign-in-with-google-button-container--register",t.DEFAULT_SIGNIN_BUTTON_CONTAINER_ID="sign-in-with-google-button-container--login",t.DEFAULT_ONE_TAP_CONTAINER_CLASS="google-one-tap-inline-container",t.DEFAULT_ONE_TAP_INLINE_TOS_ID_REGISTER="google-one-tap-inline-tos-register",t.DEFAULT_ONE_TAP_INLINE_TOS_ID_LOGIN="google-one-tap-inline-tos-login",t.GOOGLE_ONE_TAP_DISABLED_FORM="google-one-tap-form--disabled",t.GOOGLE_ONE_TAP_COLLAPSE_FORM="google-one-tap-form--collapse",t.GOOGLE_ONE_TAP_IFRAME_ID="credential_picker_iframe",t.GOOGLE_ONE_TAP_CREDENTIAL_CONTAINER_ID="credential_picker_container",t.ONE_TAP_HEIGHT_CSS_VAR="--google-one-tap-container-height",t.DEFAULT_CONTINUATION_URL="/"})),define("metaserver/static/js/google_one_tap/containers",["require","exports","tslib","classnames","react","metaserver/static/js/google_one_tap/lib","dig-components/progress_indicators","typescript/component_libraries/dwg-components/src/atoms/dwg-box/index"],(function(e,t,s,a,r,i,o,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DEFAULT_TOS_INLINE_CONTAINER_REGISTER=t.DEFAULT_TOS_INLINE_CONTAINER_LOGIN=t.DefaultButtonContainerFC=t.DefaultContainerFC=void 0,a=s.__importDefault(a);const l=(r=s.__importStar(r)).default.createElement(n.DWGBox,{marginBottom:2},r.default.createElement(o.Spinner,{"aria-valuetext":"Loading Terms of Service prompt",size:"small"}));t.DefaultContainerFC=e=>{const{context:t,gsiState:s}=e,o="signup"===t?i.DEFAULT_SIGNUP_CONTAINER_ID:i.DEFAULT_SIGNIN_CONTAINER_ID,n=(0,r.useCallback)(e=>{null!==e&&i.GSIEventManager.sendGSIEvent(i.GSIEvent.INLINE_CONTAINER_MOUNTED)},[]);return r.default.createElement("div",{id:o,className:(0,a.default)({[i.DEFAULT_ONE_TAP_CONTAINER_CLASS]:!(null==s?void 0:s.isPromptClosed)||!(null==s?void 0:s.displayMoment)}),ref:n},!(null==s?void 0:s.displayMoment)&&l)},t.DefaultContainerFC.displayName="DefaultContainerFC";t.DefaultButtonContainerFC=({context:e,gsiState:t})=>{let s,a;"signup"===e?(s="sign-in-with-google-button-register",a=i.DEFAULT_SIGNUP_BUTTON_CONTAINER_ID):"signin"===e&&(s="login-form-container__google-div",a=i.DEFAULT_SIGNIN_BUTTON_CONTAINER_ID);const o=(0,r.useCallback)(e=>{null!==e&&i.GSIEventManager.sendGSIEvent(i.GSIEvent.BUTTON_CONTAINER_MOUNTED)},[]),n=((null==t?void 0:t.tosPromptDisplayed)||(null==t?void 0:t.dismissReason)==i.DismissReason.inFlow)&&((null==t?void 0:t.isInline)||(null==t?void 0:t.isButtonFlow));return r.default.createElement("div",{ref:o,id:a,className:s,style:(null==t?void 0:t.isInline)&&(!(null==t?void 0:t.isPromptClosed)||(null==t?void 0:t.tosPromptDisplayed))||n?{display:"none"}:void 0})},t.DefaultButtonContainerFC.displayName="DefaultButtonContainerFC",t.DEFAULT_TOS_INLINE_CONTAINER_LOGIN=r.default.createElement("div",{id:i.DEFAULT_ONE_TAP_INLINE_TOS_ID_LOGIN,className:"inline-tos-container"}),t.DEFAULT_TOS_INLINE_CONTAINER_REGISTER=r.default.createElement("div",{id:i.DEFAULT_ONE_TAP_INLINE_TOS_ID_REGISTER,className:"inline-tos-container"})}));
//# sourceMappingURL=pkg-login-and-register-pages.min.js-vflkLz07Y.map